<!doctype html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TZZ1VK3VGL"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date()); gtag('config', 'G-TZZ1VK3VGL');</script>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/svg" href="img/logo.svg">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="https://servicestack.net/feed.xml" />
    <title>Modelling TypeChat&#x27;s CoffeeShop in .NET - ServiceStack</title>
    <base href="/" />
    <script>
    if (location.search === "?dark") localStorage.setItem('color-scheme','dark') 
    if (location.search === "?light") localStorage.removeItem('color-scheme') 
    const cls = document.querySelector('html').classList
    if (localStorage.getItem('color-scheme') === 'dark')
        cls.add('dark')
    else
        cls.remove('dark')
    </script>
    <link rel="stylesheet" href="css/app.css">

    <script type="importmap">
{
    "imports": {
        "app.mjs": "./mjs/app.mjs",
        "dtos.mjs": "./mjs/dtos.mjs",
        "vue": "./lib/mjs/vue.min.mjs",
        "@servicestack/client": "./lib/mjs/servicestack-client.min.mjs",
        "@servicestack/vue": "./lib/mjs/servicestack-vue.min.mjs",
        "highlight.mjs": "./lib/mjs/highlight.mjs",
        "core": "./js/core.mjs"
    }
}
</script>
    
    <meta name="twitter:site" content="@ServiceStack" />
    <meta name="twitter:creator" content="@demisbellot" />
    <meta name="twitter:card" content="summary" />
    <meta property="og:description" content="We look at Modelling TypeChat&#x27;s CoffeeShop App" />
    <meta property="og:url" content="https://servicestack.net/posts/building-typechat-coffeeshop-modelling" />
    <meta property="og:title" content="Modelling TypeChat&#x27;s CoffeeShop in .NET" />
    <meta property="og:image" content="./img/posts/building-typechat-coffeeshop-modelling/bg.webp" />


</head>
<body class="bg-white dark:bg-black dark:text-white">
<header class="top-0 fixed z-50 h-14 bg-white dark:bg-black opacity-90 w-full shadow pr-3">
    <div class="w-full flex flex-wrap items-center">
        <div class="absolute z-10 top-2 left-2 sm:static flex-shrink flex-grow-0">
            <div class="cursor-pointer">
                <a class="navbar-brand flex items-center" href="./">
                    <svg class="w-8 h-8 sm:ml-2 sm:w-12 sm:h-12 text-gray-900 dark:text-gray-50" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path fill="currentColor" d="M10 6c1.544 1.76 2.276 4.15 2.217 6.61c3.968 1.67 9.924 6.12 11.181 12.39H28C26.051 14.31 14.918 6.77 10 6zm-2 7c4.67 4.913.81 11.582-4 12h18.97C21.5 18.289 11.95 13.533 8 13z"/></svg>
                    <span class="hidden sm:block text-2xl font-bold text-gray-900 dark:text-gray-50">ServiceStack</span>
                </a>
            </div>
        </div>
        <div class="flex flex-grow flex-shrink flex-nowrap justify-end items-center">
            <nav class="relative flex flex-grow leading-6 font-semibold text-slate-700 dark:text-slate-200">
                <ul class="flex flex-wrap items-center justify-end w-full m-0 pb-2 sm:pb-0">
                            <li class="relative flex flex-wrap just-fu-start m-0">
                                <a href="https://servicestack.net/whatsnew" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400">
                                    What's New
                                </a>
                            </li>
                            <li class="relative flex flex-wrap just-fu-start m-0">
                                <a href="https://servicestack.net/blog" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400">
                                    Blog
                                </a>
                            </li>
                            <li class="relative flex flex-wrap just-fu-start m-0 hidden lg:block">
                                <a href="https://servicestack.net/podcasts" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400">
                                    Podcasts
                                </a>
                            </li>
                            <li class="relative flex flex-wrap just-fu-start m-0 hidden lg:block">
                                <a href="https://docs.servicestack.net" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400">
                                    Docs
                                </a>
                            </li>
                            <li class="relative flex flex-wrap just-fu-start m-0 hidden lg:block">
                                <a href="https://forums.servicestack.net" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400">
                                    Forums
                                </a>
                            </li>
                            <li class="relative flex flex-wrap just-fu-start m-0">
                                <a href="https://servicestack.net/free" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400">
                                    Free
                                </a>
                            </li>
                            <li class="relative flex flex-wrap just-fu-start m-0">
                                <a href="https://servicestack.net/trial" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400">
                                    Trial
                                </a>
                            </li>
                            <li class="relative flex flex-wrap just-fu-start m-0">
                                <a href="https://servicestack.net/pricing" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400">
                                    Pricing
                                </a>
                            </li>
                            <li class="relative flex flex-wrap just-fu-start m-0">
                                <a href="https://servicestack.net/account/subscription" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400 text-gray-50 sm:text-slate-700 dark:text-gray-50">
                                    Sign In
                                </a>
                            </li>
                    <li class="relative flex flex-wrap just-fu-start m-0">
                        <div data-component="DarkModeToggle" class="ml-2 w-10"></div>
                    </li>
                </ul>
            </nav>

        </div>
    </div>
</header>
<script type="module">
import { mountAll } from "app.mjs"
mountAll()
</script>


<div class="min-h-screen">
    <main role="main" class="pt-14">
        



<link rel="stylesheet" href="css/typography.css">
<link rel="stylesheet" href="css/lite-yt-embed.css">

<div class="container px-5 mb-32 mx-auto">
        <article class="mt-20">
            <h1 class="text-6xl md:text-7xl lg:text-8xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-center md:text-left">
                Modelling TypeChat&#x27;s CoffeeShop in .NET
            </h1>
            <div class="flex flex-wrap justify-between">
                <div class="md:mb-12 flex items-center">
                        <a href="posts/author/demis-bellot"><img class="w-12 h-12 rounded-full mr-4 text-cyan-600" src="/img/authors/demis.jpg"></a>
                    <div class="flex flex-col">
                            <a class="text-xl font-semibold hover:underline" href="posts/author/demis-bellot">Demis Bellot</a>
            <ul role="list" class="flex">
                    <li>
                        <a title="Follow on Twitter" class="mr-1 group flex text-sm font-medium text-zinc-800 transition hover:text-indigo-500 dark:text-zinc-200 dark:hover:text-indigo-500" href="https://twitter.com/demisbellot">
                            <svg viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6 flex-none text-zinc-500 fill-zinc-500 transition group-hover:fill-indigo-500">
                                <path d="M20.055 7.983c.011.174.011.347.011.523 0 5.338-3.92 11.494-11.09 11.494v-.003A10.755 10.755 0 0 1 3 18.186c.308.038.618.057.928.058a7.655 7.655 0 0 0 4.841-1.733c-1.668-.032-3.13-1.16-3.642-2.805a3.753 3.753 0 0 0 1.76-.07C5.07 13.256 3.76 11.6 3.76 9.676v-.05a3.77 3.77 0 0 0 1.77.505C3.816 8.945 3.288 6.583 4.322 4.737c1.98 2.524 4.9 4.058 8.034 4.22a4.137 4.137 0 0 1 1.128-3.86A3.807 3.807 0 0 1 19 5.274a7.657 7.657 0 0 0 2.475-.98c-.29.934-.9 1.729-1.713 2.233A7.54 7.54 0 0 0 22 5.89a8.084 8.084 0 0 1-1.945 2.093Z"></path>
                            </svg>
                        </a>
                    </li>
                    <li>
                        <a title="Follow on threads.net" class="mr-1 group flex text-sm font-medium text-zinc-800 transition hover:text-indigo-500 dark:text-zinc-200 dark:hover:text-indigo-500" href="https://threads.net/@demisbellot">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 flex-none text-zinc-500 fill-zinc-500 transition group-hover:fill-indigo-500" width="24" height="24" viewBox="0 0 24 24">
                                <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7.5c-1.333-3-3.667-4.5-7-4.5c-5 0-8 2.5-8 9s3.5 9 8 9s7-3 7-5s-1-5-7-5c-2.5 0-3 1.25-3 2.5C9 15 10 16 11.5 16c2.5 0 3.5-1.5 3.5-5s-2-4-3-4s-1.833.333-2.5 1"/>
                            </svg>
                        </a>
                    </li>
                    <li>
                        <a title="Follow on GitHub" class="mr-1 group flex text-sm font-medium text-zinc-800 transition hover:text-indigo-500 dark:text-zinc-200 dark:hover:text-indigo-500" href="https://github.com/mythz">
                            <svg viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6 flex-none text-zinc-500 fill-zinc-500 transition group-hover:fill-indigo-500">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C6.475 2 2 6.588 2 12.253c0 4.537 2.862 8.369 6.838 9.727.5.09.687-.218.687-.487 0-.243-.013-1.05-.013-1.91C7 20.059 6.35 18.957 6.15 18.38c-.113-.295-.6-1.205-1.025-1.448-.35-.192-.85-.667-.013-.68.788-.012 1.35.744 1.538 1.051.9 1.551 2.338 1.116 2.912.846.088-.666.35-1.115.638-1.371-2.225-.256-4.55-1.14-4.55-5.062 0-1.115.387-2.038 1.025-2.756-.1-.256-.45-1.307.1-2.717 0 0 .837-.269 2.75 1.051.8-.23 1.65-.346 2.5-.346.85 0 1.7.115 2.5.346 1.912-1.333 2.75-1.05 2.75-1.05.55 1.409.2 2.46.1 2.716.637.718 1.025 1.628 1.025 2.756 0 3.934-2.337 4.806-4.562 5.062.362.32.675.936.675 1.897 0 1.371-.013 2.473-.013 2.82 0 .268.188.589.688.486a10.039 10.039 0 0 0 4.932-3.74A10.447 10.447 0 0 0 22 12.253C22 6.588 17.525 2 12 2Z"></path>
                            </svg>
                        </a>
                    </li>
                    <li>
                        <a title="Email Demis Bellot" href="mailto:demis@servicestack.com" class="mr-1 group flex text-sm font-medium text-zinc-800 transition hover:text-indigo-500 dark:text-zinc-200 dark:hover:text-indigo-500">
                            <svg class="h-6 w-6 flex-none text-zinc-500 fill-zinc-500 transition group-hover:fill-indigo-500" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M4 20q-.825 0-1.413-.588T2 18V6q0-.825.588-1.413T4 4h16q.825 0 1.413.588T22 6v12q0 .825-.588 1.413T20 20H4Zm8-7L4 8v10h16V8l-8 5Zm0-2l8-5H4l8 5ZM4 8V6v12V8Z"/></svg>
                        </a>
                    </li>
            </ul>
                    </div>
                </div>
                <div class="mb-4 max-w-sm" data-mail="JoinMailingList" data-props="{ submitLabel:'Join our newsletter' }"></div>
            </div>
            
            <div class="mb-8 md:mb-16 sm:mx-0">
                <div class="sm:mx-0">
                    <img src="./img/posts/building-typechat-coffeeshop-modelling/bg.webp" alt="Modelling TypeChat&#x27;s CoffeeShop in .NET Background" class="shadow-small">
                </div>
            </div>
            <div class="flex max-w-3xl mx-auto justify-between">
                <div>
                    <div class="mb-4 flex flex-wrap">
                        <a href="posts/tagged/autoquery" class="mr-2 text-xs leading-5 font-semibold bg-slate-400/10 rounded-full py-1 px-3 flex items-center space-x-2 hover:bg-slate-400/20 dark:highlight-white/5">autoquery</a>
                        <a href="posts/tagged/csharp" class="mr-2 text-xs leading-5 font-semibold bg-slate-400/10 rounded-full py-1 px-3 flex items-center space-x-2 hover:bg-slate-400/20 dark:highlight-white/5">c#</a>
                        <a href="posts/tagged/dev" class="mr-2 text-xs leading-5 font-semibold bg-slate-400/10 rounded-full py-1 px-3 flex items-center space-x-2 hover:bg-slate-400/20 dark:highlight-white/5">dev</a>
                        <a href="posts/tagged/servicestack" class="mr-2 text-xs leading-5 font-semibold bg-slate-400/10 rounded-full py-1 px-3 flex items-center space-x-2 hover:bg-slate-400/20 dark:highlight-white/5">servicestack</a>
                    </div>
                        <div class="max-w-3xl mx-auto">
                            <div class="mb-6 text-lg text-gray-500">
                                <time datetime="2023-09-12T00:00:00.0000000">September 12, 2023</time>
                                <span aria-hidden="true">&middot;</span>
                                <span>32 min read</span>
                            </div>
                        </div>
                </div>
                <div class="flex flex-grow-0">
                    <div data-post="PostVotes"></div>
                    <a href="javascript:;" onclick="document.location.hash='comments'" class="cursor-pointer" title="Jump to comments">
                        <svg class="ml-4 text-gray-700 mt-1 w-7 h-7" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill="currentColor" d="M3 11.2c0 .1 0 .1 0 0c0 .1 0 .1 0 0zM8.3 1C3.9 1 0 3.6 0 6.6c0 2 1.1 3.7 3 4.7s0 .1 0 .1c-.1 1.3-.9 1.7-.9 1.7L.3 14h2c2.5 0 4.3-1.1 5.1-1.9h.8c4.3 0 7.8-2.5 7.8-5.6S12.6 1 8.3 1zm-.1 10.1H7l-.2.2c-.5.5-1.6 1.4-3.3 1.7c.3-.5.5-1.1.5-2v-.3l-.3-.1C1.9 9.7 1 8.3 1 6.6C1 4.2 4.5 2 8.3 2C12 2 15 4 15 6.6c0 2.4-3.1 4.5-6.8 4.5z"/></svg>
                    </a>
                </div>
            </div>
            <div class="max-w-3xl mx-auto">
                <div id="post" class="prose lg:prose-xl max-w-none mb-32">
                    <h2 id="building-a-typechat-coffeeshop.net-app">Building a TypeChat CoffeeShop .NET App<a class="header-anchor" href="javascript:;" onclick="location.hash='#building-a-typechat-coffeeshop.net-app'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>Since the release of <a href="https://chat.openai.com">Open AI's Chat GPT</a> we've been exploring its potential
in unlocking new AI powered capabilities in our Apps that were previously limited to Large companies
with dedicated AI development teams, now their capabilities is within everyone's reach with just 1 API call away!</p>
<div class="py-8 max-w-7xl mx-auto px-4 sm:px-6">
    <lite-youtube class="w-full mx-4 my-4" width="560" height="315" videoid="MjNqPAXLH5w" style="background-image: url('https://img.youtube.com/vi/MjNqPAXLH5w/maxresdefault.jpg')"></lite-youtube>
</div>
<h3 id="chain-of-thought-prompt-engineering">Chain of thought Prompt engineering<a class="header-anchor" href="javascript:;" onclick="location.hash='#chain-of-thought-prompt-engineering'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>Our initial approach of leveraging LLMs was to <a href="/posts/chat-gpt-agents">create ChatGPT Agents to call APIs</a>
by adopting the <a href="https://arxiv.org/abs/2201.11903">Chain-of-Thought</a> technique popularized by
<a href="https://github.com/Significant-Gravitas/Auto-GPT">Auto-GPT</a> where along with the goal we also ask it for its
<strong>plan</strong>, <strong>reasoning</strong>, and <strong>criticism</strong> which influences its future decisions to help break down its tasks into
smaller, more achievable steps.</p>
<p>We adopt this approach within a scoped context with just the APIs that we want Chat GPT to know about in order to
accomplish purpose specific tasks we assign it. We showcase the utility of this approach in
<a href="https://github.com/NetCoreApps/GPTMeetingAgent">GPTMeetingAgent(github)</a> in which we use the GPT Meeting Agent
to use available APIs to search for Users and book Meetings:</p>
<div class="not-prose my-16 px-4 sm:px-6">
    <div class="text-center">
        <h3 class="text-4xl sm:text-5xl md:text-6xl tracking-tight font-extrabold text-gray-900">
            <a class="text-indigo-600 hover:text-indigo-600" href="https://gptmeetings.netcore.io">gptmeetings.netcore.io</a>
        </h3>
    </div>
    <p class="mx-auto pt-5 text-xl text-gray-500"> 
        Use Natural Language to get GPT Agents to book meetings with your APIs
    </p>
    <div class="my-8">
        <div class="flex justify-center">
            <lite-youtube class="w-full mx-4 my-4" width="560" height="315" videoid="7vChIGHWPuI" style="background-image: url('https://img.youtube.com/vi/7vChIGHWPuI/maxresdefault.jpg')"></lite-youtube>
        </div>
    </div>
</div>
<p>This approach relies on a fairly sophisticated prompt to get the desired outcome whose probability of a successful response
is dependent on the ambiguity and complexity of a command and the surface complexity of the APIs they need to call.</p>
<p>The difficulty then becomes how best to construct the interface of our System APIs to LLMs and how best to detect a valid
response from an invalid one. In our experience the key to best guiding LLMs to produce a valid response is to front load
the prompt with descriptive information of available functionality it should utilize and constrain its output to a restricted
surface area.</p>
<h3 id="typechat">TypeChat<a class="header-anchor" href="javascript:;" onclick="location.hash='#typechat'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>Microsoft's new <a href="https://github.com/microsoft/TypeChat">TypeChat</a> library takes another interesting approach to interfacing with LLMs where instead of
using chain of thought to continually refine LLM outputs towards a valid successful response, it relies on using
TypeScript schemas to define and restrict what valid responses Chat GPT should return, which both validates LLM responses
to verify if they're valid and if not replies back with Schema Validation errors to guide GPT into returning a successful response.</p>
<p>Whilst this approach is less ambitious and open ended from harnessing the reasoning capabilities of LLMs than Chain of Thought,
it's easier to develop from a pragmatic view where instead of tweaking and refining prompt templates to get more desirable
outcomes you're defining TypeScript schemas of what you want the Natural Language free text to convert into.</p>
<p><a href="https://github.com/microsoft/TypeChat/tree/main/examples/coffeeShop">TypeChat's CoffeeShop</a>
is a good example of what this looks like in real world application which uses LLMs to
implement a natural language ordering system by capturing all the different ways a Customer can order at a Cafe,
as defined in:
<a href="https://github.com/microsoft/TypeChat/blob/main/examples/coffeeShop/src/coffeeShopSchema.ts">coffeeShopSchema.ts</a></p>
<pre><code class="language-ts">// The following is a schema definition for ordering lattes.

export interface Cart {
    items: (LineItem | UnknownText)[];
}

// Use this type for order items that match nothing else
export interface UnknownText {
    type: 'unknown',
    text: string; // The text that wasn't understood
}

export interface LineItem {
    type: 'lineitem',
    product: Product;
    quantity: number;
}

export type Product = BakeryProducts | LatteDrinks | EspressoDrinks | CoffeeDrinks;

export interface BakeryProducts {
    type: 'BakeryProducts';
    name: 'apple bran muffin' | 'blueberry muffin' | 'lemon poppyseed muffin' |'bagel'
    options: (BakeryOptions | BakeryPreparations)[];
}

export interface BakeryOptions {
    type: 'BakeryOptions';
    name: 'butter' | 'strawberry jam' | 'cream cheese';
    optionQuantity?: OptionQuantity;
}

export interface BakeryPreparations {
    type: 'BakeryPreparations';
    name: 'warmed' | 'cut in half';
}

export interface LatteDrinks {
    type: 'LatteDrinks';
    name: 'cappuccino' | 'flat white' | 'latte' | 'macchiato' | 'mocha' |'chai latte'
    temperature?: CoffeeTemperature;
    size?: CoffeeSize;  // The default is 'grande'
    options?:(Milks | Sweeteners | Syrups | Toppings | Caffeines|LattePreparations)[]
}

// more categories and products...
export type CoffeeTemperature = 'hot' | 'extra hot' | 'warm' | 'iced';

export type CoffeeSize = 'short' | 'tall' | 'grande' | 'venti';

export type EspressoSize = 'solo' | 'doppio' | 'triple' | 'quad';

export type OptionQuantity = 'no' | 'light' | 'regular' | 'extra' | number;
</code></pre>
<p>We can see TypeScript's expressive Type System really shines here which is easily able to succinctly express all
available products and options with minimal syntax. It's also worth noting the schema is solely concerned with the orders
customers are able to make and not about how the data is modelled in a datastore which is a good approach when interfacing
with LLMs to increase the probability of a successful result.</p>
<p>But to be useful App's still need to model their data model which as a goal needs to:</p>
<ul>
<li>Capture all categories and products Customers can order</li>
<li>Be able to dynamically generate the resulting TypeScript Schema</li>
<li>Persist in a Data Store</li>
<li>Enable management through a User Friendly UI</li>
</ul>
<p>Which will be the initial goal of our .NET App. FortunatelyTypeScript schema also serves as a great requirements documentation,
clearly and precisely defining all the categories, products, relationships and variants our Data Model needs to support.</p>
<h3 id="code-first-data-modelling">Code-First Data Modelling<a class="header-anchor" href="javascript:;" onclick="location.hash='#code-first-data-modelling'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>This can be easily done in code-first ORMs like <a href="https://docs.servicestack.net/ormlite/">OrmLite</a> which lets you design
RDBMS Tables with simple POCO classes. Since we'll also be using the Data Model to generate our online store we'll also add
an <code>ImageUrl</code> on <strong>Category</strong> and <strong>Product</strong> Models.</p>
<p>OrmLite also supports persisting complex types on Data Models which are serialized with the RDBMS configured
<a href="https://docs.servicestack.net/ormlite/complex-type-serializers">Complex Type Serializer</a> which saves from requiring
a number of unnecessary code tables and inefficient table joins for table data that doesn't need to be queried server-side.</p>
<p>By utilizing complex type collections we can get this down to <strong>5 tables</strong> to define a data model that supports capturing the
categories, products, options and relationships in the <a href="https://github.com/microsoft/TypeChat/blob/main/examples/coffeeShop/src/coffeeShopSchema.ts">coffeeShopSchema.ts</a>:</p>
<pre><code class="language-csharp">public class Category
{
    [AutoIncrement]
    public int Id { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    public List&lt;string&gt;? Temperatures { get; set; }
    public string? DefaultTemperature { get; set; }
    public List&lt;string&gt;? Sizes { get; set; }
    public string? DefaultSize { get; set; }
    public string? ImageUrl { get; set; }
    
    [Reference]
    public List&lt;Product&gt; Products { get; set; }

    [Reference]
    public List&lt;CategoryOption&gt; CategoryOptions { get; set; }
}

public class Product
{
    [AutoIncrement]
    public int Id { get; set; }
    [References(typeof(Category))]
    public int CategoryId { get; set; }
    public string Name { get; set; }
    public decimal Cost { get; set; }
    public string? ImageUrl { get; set; }

    [Reference]
    public Category Category { get; set; }
}

public class Option
{
    [AutoIncrement]
    public int Id { get; set; }
    public string Type { get; set; }
    public List&lt;string&gt; Names { get; set; }
    public bool? AllowQuantity { get; set; }
    public string? QuantityLabel { get; set; }
}

public class OptionQuantity
{
    [AutoIncrement]
    public int Id { get; set; }
    public string Name { get; set; }
    public decimal Value { get; set; }
}

public class CategoryOption
{
    [AutoIncrement]
    public int Id { get; set; } 
    [References(typeof(Category))]
    public int CategoryId { get; set; }
    [References(typeof(Option))]
    public int OptionId { get; set; }
}
</code></pre>
<div class="info custom-block">
            <p class="custom-block-title">INFO</p><p>The <code>[Reference]</code> attributes defines <a href="https://docs.servicestack.net/ormlite/reference-support">POCO References</a> for pulling
in data from related tables in OrmLite's <code>Load*</code> APIs</p>
</div>
<h2 id="creating-the-coffeeshop-database">Creating the CoffeeShop Database<a class="header-anchor" href="javascript:;" onclick="location.hash='#creating-the-coffeeshop-database'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>Next step is to create the RDBMS tables, which we recommend doing from within a
<a href="https://docs.servicestack.net/ormlite/db-migrations">Code-First DB Migration</a> class so they can be easily run, re-run
and extend over time.</p>
<p>For this we can just copy all data models into a
<a href="https://github.com/NetCoreApps/CoffeeShop/blob/main/CoffeeShop/Migrations/Migration1000.cs">Migration1000.cs</a>
class which represents the initial state of the Application database, where all RDBMS tables are created and populated
in the <code>Up()</code> method and tables deleted and drop in the <code>Down()</code> method:</p>
<pre><code class="language-csharp">public class Migration1000 : MigrationBase
{
    // Embedded copy of Data Models...
    
    public override void Up()
    {
        Db.CreateTable&lt;Category&gt;();
        Db.CreateTable&lt;Option&gt;();
        Db.CreateTable&lt;OptionQuantity&gt;();
        Db.CreateTable&lt;CategoryOption&gt;();
        Db.CreateTable&lt;Product&gt;();
        
        Db.SaveAll(new OptionQuantity[]
        {
            new() { Name = &quot;no&quot;, Value = 0 },
            new() { Name = &quot;light&quot;, Value = 0.5m },
            new() { Name = &quot;regular&quot;, Value = 1 },
            new() { Name = &quot;extra&quot;, Value = 2 },
        });
        
        void AddOptions(string type, string[] names, bool? allowQuantity = false, string? quantityLabel = null)
        {
            var item = new Option
            {
                Type = type,
                Names = new(names),
                AllowQuantity = allowQuantity,
                QuantityLabel = quantityLabel,
            };
            Db.Save(item);
        }
        
        AddOptions(&quot;BakeryOptions&quot;, new[] {
            &quot;Butter&quot;, 
            &quot;Strawberry Jam&quot;, 
            &quot;Cream Cheese&quot;,
        });
        AddOptions(&quot;BakeryPreparations&quot;, new[] {
            &quot;Warmed&quot;, 
            &quot;Cut in Half&quot;, 
        });
        AddOptions(&quot;Milks&quot;, new[] {
            &quot;Whole Milk&quot;, 
            &quot;Two Percent Milk&quot;, 
            &quot;NonFat Milk&quot;, 
            &quot;Coconut Milk&quot;, 
            &quot;Soy Milk&quot;, 
            &quot;Almond Milk&quot;, 
            &quot;Oat Milk&quot;,
        });
        //....
        
        void AddCategoryProducts(string category, 
            (string name, decimal cost)[] productInfos, 
            string[]? optionTypes = null,
            string[]? temperatures = null,
            string? defaultTemperature = null,
            string[]? sizes = null,
            string? defaultSize = null)
        {
            var cat = new Category
            {
                Name = category,
                Description = category.SplitCamelCase(),
                Temperatures = temperatures != null ? new(temperatures) : null,
                DefaultTemperature = defaultTemperature,
                Sizes = sizes != null ? new(sizes) : null,
                DefaultSize = defaultSize,
                ImageUrl = $&quot;/products/{category.SplitCamelCase().GenerateSlug()}.jpg&quot;,
            };
            Db.Save(cat);

            foreach (var optionType in optionTypes.Safe())
            {
                var option = options.First(x =&gt; x.Type == optionType);
                var categoryOption = new CategoryOption
                {
                    CategoryId = cat.Id,
                    OptionId = option.Id,
                };
                Db.Save(categoryOption);
            }
            
            foreach (var productInfo in productInfos)
            {
                var product = new Product
                {
                    CategoryId = cat.Id,
                    Name = productInfo.name,
                    Cost = productInfo.cost,
                    ImageUrl = $&quot;/products/{productInfo.name.GenerateSlug()}.jpg&quot;,
                };
                Db.Save(product);
            }
        }

        AddCategoryProducts(&quot;BakeryProducts&quot;, new[] {
            (&quot;Apple Bran Muffin&quot;, 4m),
            (&quot;Blueberry Muffin&quot;, 4),
            (&quot;Lemon Poppy seed Muffin&quot;, 4),
            (&quot;Bagel&quot;, 4),
        }, new[]{ &quot;BakeryOptions&quot;, &quot;BakeryPreparations&quot; });
        
        AddCategoryProducts(&quot;LatteDrinks&quot;, new[] {
            (&quot;Cappuccino&quot;, 5.5m),
            (&quot;Flat White&quot;, 5),
            (&quot;Latte&quot;, 5),
            (&quot;Latte Macchiato&quot;, 5),
            (&quot;Mocha&quot;, 4.5m),
            (&quot;Chai Latte&quot;, 4),
        }, new[] { &quot;Milks&quot;, &quot;Sweeteners&quot;, &quot;Syrups&quot;, &quot;Toppings&quot;, &quot;Caffeines&quot;, &quot;LattePreparations&quot; },
           new[] { &quot;Iced&quot;, &quot;Warm&quot;, &quot;Hot&quot;, &quot;Extra Hot&quot; }, defaultTemperature:&quot;Hot&quot;,
           new[] { &quot;Short&quot;, &quot;Tall&quot;, &quot;Grande&quot;, &quot;Venti&quot; }, defaultSize:&quot;Grande&quot;);
        //...
    }
    
    public override void Down()
    {
        // Delete referential foreign key data first
        Db.DeleteAll&lt;Product&gt;();
        Db.DeleteAll&lt;CategoryOption&gt;();
        Db.DeleteAll&lt;OptionQuantity&gt;();
        Db.DeleteAll&lt;Option&gt;();
        Db.DeleteAll&lt;Category&gt;();

        Db.DropTable&lt;Product&gt;();
        Db.DropTable&lt;CategoryOption&gt;();
        Db.DropTable&lt;OptionQuantity&gt;();
        Db.DropTable&lt;Option&gt;();
        Db.DropTable&lt;Category&gt;();
    }
}
</code></pre>
<p>Within the <code>Up()</code> method we can utilize everything C# offers including Tuples and local functions to populate the
database with minimal boilerplate. The <code>Down()</code> method just needs to undo everything the <code>Up()</code> method does, which
typically means dropping any new tables with <code>Db.DropTable&lt;T&gt;</code> in the reverse order they were created, the data
only needs to be deleted first if tables have foreign keys and foreign key enforcement is enabled.</p>
<h3 id="running-migrations">Running Migrations<a class="header-anchor" href="javascript:;" onclick="location.hash='#running-migrations'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>After creating the initial migration all that's left is to run it, which you can do from the command-line with:</p>
<div class="not-prose sh-copy cp flex cursor-pointer mb-3" onclick="copy(this)">
                <div class="flex-grow bg-gray-800">
                    <div class="pl-4 py-1 pb-1.5 align-middle whitespace-pre text-base text-gray-100"><p>npm run migrate</p>
</div>
                    </div>
                <div class="flex">
                    <div class="bg-green-600 text-white p-1.5 pb-0">
                        <svg class="copied w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                        <svg class="nocopy w-6 h-6" title="copy" fill='none' stroke='white' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
                            <path stroke-linecap='round' stroke-linejoin='round' stroke-width='1' d='M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2'></path>
                        </svg>
                    </div>
                </div>
            </div>
<p>Which is an alias for <a href="https://docs.servicestack.net/ormlite/db-migrations#dotnet-migration-tasks">dotnet Migration App Tasks</a>
to run your App in the context of a Migration App Tasks.</p>
<p>Alternatively Migration Tasks can also be run from within your IDE by running the <code>Migrate()</code> Unit Test in
<a href="https://github.com/NetCoreApps/CoffeeShop/blob/main/CoffeeShop.Tests/MigrationTasks.cs">CoffeeShop's MigrationTasks.cs</a></p>
<h3 id="rerunning-the-last-migration">Rerunning the last Migration<a class="header-anchor" href="javascript:;" onclick="location.hash='#rerunning-the-last-migration'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>Often you'll need a few iterations before you're happy with the your current set of Database changes, a productive workflow
for making iterative changes to your current migration you're actively working on (but haven't committed) is to make changes
to your current migration then revert and re-run it, which you and do with the <code>Rerun_Last_Migration()</code> Unit Test or
on the command-line with:</p>
<div class="not-prose sh-copy cp flex cursor-pointer mb-3" onclick="copy(this)">
                <div class="flex-grow bg-gray-800">
                    <div class="pl-4 py-1 pb-1.5 align-middle whitespace-pre text-base text-gray-100"><p>npm run rerun:last</p>
</div>
                    </div>
                <div class="flex">
                    <div class="bg-green-600 text-white p-1.5 pb-0">
                        <svg class="copied w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                        <svg class="nocopy w-6 h-6" title="copy" fill='none' stroke='white' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
                            <path stroke-linecap='round' stroke-linejoin='round' stroke-width='1' d='M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2'></path>
                        </svg>
                    </div>
                </div>
            </div>
<p>Or for your first DB Migration you could also delete the entire <code>App_Data\db.sqlite</code> database and re-run <code>npm run migrate</code>
to rerun migrations and recreate the database.</p>
<h3 id="viewing-the-app-database">Viewing the App database<a class="header-anchor" href="javascript:;" onclick="location.hash='#viewing-the-app-database'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>By default CoffeeShop is configured to use an embedded SQLite database at <code>App_Data\db.sqlite</code> which you can inspect
with your favorite RDBMS viewer. My favorite all-purpose database tool is <a href="https://www.jetbrains.com/datagrip/">JetBrains DataGrip</a>
but if you're using Rider you can simply drag <strong>db.sqlite</strong> to Rider's <strong>Database</strong> panel to view it within the same IDE:</p>
<div class="shadow rounded-sm"><p><a href="/img/posts/building-typechat-coffeeshop-modelling/db.png"><img src="/img/posts/building-typechat-coffeeshop-modelling/db.png" alt="" /></a></p>
</div>
<h2 id="building-the-ui-and-api">Building the UI and API<a class="header-anchor" href="javascript:;" onclick="location.hash='#building-the-ui-and-api'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>With the Data Models and Database created we can get to the fun stuff in building our App's APIs and UI. Luckily this
is effortless with AutoQuery where most of it can be done without any implementation - i.e. by just using code-first
DTOs to describe the API we want, then ServiceStack's <a href="/autoquery">AutoQuery</a> and <a href="/vue/">Vue Components</a> does the rest.</p>
<p>For this we just create the <a href="https://docs.servicestack.net/autoquery/crud">AutoQuery CRUD</a> APIs for the functionality
we want to enable. E.g.</p>
<ul>
<li>Defining <code>QueryDb&lt;T&gt;</code> for a Data Model allows it to be queried</li>
<li>Defining <code>ICreateDb&lt;T&gt;</code> enables new rows to be created</li>
<li>Defining <code>IPatchDb&lt;T&gt;</code> enables rows to be updated</li>
<li>Defining <code>IDeleteDb&lt;T&gt;</code> enables rows to be deleted</li>
</ul>
<p>So that CoffeeShop owners can manage their own database we'll implement AutoQuery CRUD APIs for the <code>Category</code>, <code>Product</code>,
<code>Option</code> and <code>OptionQuantity</code> tables. We'll handle the <strong>Many to Many</strong> <code>CategoryOption</code> table later as it's not something
users will want to manage directly.</p>
<p>We can accomplish the bulk of the functionality we need by with the CRUD APIs below after copying all the properties
from the DataModels we want users to be able to Create / Edit:</p>
<pre><code class="language-csharp">public class QueryCategories : QueryDb&lt;Category&gt; {}
public class CreateCategory : ICreateDb&lt;Category&gt;, IReturn&lt;Category&gt;
{
    public string Name { get; set; }
    public string Description { get; set; }
    [Input(Type = &quot;tag&quot;), FieldCss(Field = &quot;col-span-12&quot;)]
    public List&lt;string&gt;? Sizes { get; set; }
    [Input(Type = &quot;tag&quot;), FieldCss(Field = &quot;col-span-12&quot;)]
    public List&lt;string&gt;? Temperatures { get; set; }
    public string? DefaultSize { get; set; }
    public string? DefaultTemperature { get; set; }
    [Input(Type = &quot;file&quot;), UploadTo(&quot;products&quot;)]
    public string? ImageUrl { get; set; }
}
public class UpdateCategory : IPatchDb&lt;Category&gt;, IReturn&lt;Category&gt;
{
    public int Id { get; set; }
    public string? Name { get; set; }
    public string? Description { get; set; }
    [Input(Type = &quot;tag&quot;), FieldCss(Field = &quot;col-span-12&quot;)]
    public List&lt;string&gt;? Sizes { get; set; }
    [Input(Type = &quot;tag&quot;), FieldCss(Field = &quot;col-span-12&quot;)]
    public List&lt;string&gt;? Temperatures { get; set; }
    public string? DefaultSize { get; set; }
    public string? DefaultTemperature { get; set; }
    [Input(Type = &quot;file&quot;), UploadTo(&quot;products&quot;)]
    public string? ImageUrl { get; set; }
}
public class DeleteCategory : IDeleteDb&lt;Category&gt;, IReturnVoid
{
    public int Id { get; set; }
}

public class QueryProducts : QueryDb&lt;Product&gt; {}
public class CreateProduct : ICreateDb&lt;Product&gt;, IReturn&lt;Product&gt;
{
    public int CategoryId { get; set; }
    public string Name { get; set; }
    public decimal Cost { get; set; }
    [Input(Type = &quot;file&quot;), UploadTo(&quot;products&quot;)]
    public string? ImageUrl { get; set; }
}
public class UpdateProduct : IPatchDb&lt;Product&gt;, IReturn&lt;Product&gt;
{
    public int Id { get; set; }
    public int? CategoryId { get; set; }
    public string? Name { get; set; }
    public decimal? Cost { get; set; }
    [Input(Type = &quot;file&quot;), UploadTo(&quot;products&quot;)]
    public string? ImageUrl { get; set; }
}
public class DeleteProduct : IDeleteDb&lt;Product&gt;, IReturnVoid
{
    public int Id { get; set; }
}

public class QueryOptions : QueryDb&lt;Option&gt; {}
public class CreateOption : ICreateDb&lt;Option&gt;, IReturn&lt;Option&gt;
{
    public string Type { get; set; }
    [Input(Type = &quot;tag&quot;), FieldCss(Field = &quot;col-span-12&quot;)]
    public List&lt;string&gt; Names { get; set; }
    public bool? AllowQuantity { get; set; }
    public string? QuantityLabel { get; set; }
}
public class UpdateOption : IPatchDb&lt;Option&gt;, IReturn&lt;Option&gt;
{
    public int Id { get; set; }
    public string? Type { get; set; }
    [Input(Type = &quot;tag&quot;), FieldCss(Field = &quot;col-span-12&quot;)]
    public List&lt;string&gt;? Names { get; set; }
    public bool? AllowQuantity { get; set; }
    public string? QuantityLabel { get; set; }
}
public class DeleteOption : IDeleteDb&lt;Option&gt;, IReturnVoid
{
    public int Id { get; set; }
}

public class QueryOptionQuantities : QueryDb&lt;OptionQuantity&gt; {}
public class CreateOptionQuantity : ICreateDb&lt;OptionQuantity&gt;, IReturn&lt;OptionQuantity&gt;
{
    public string Name { get; set; }
}
public class UpdateOptionQuantity : IPatchDb&lt;OptionQuantity&gt;, IReturn&lt;OptionQuantity&gt;
{
    public int Id { get; set; }
    public string? Name { get; set; }
}
public class DeleteOptionQuantity : IDeleteDb&lt;OptionQuantity&gt;, IReturnVoid
{
    public int Id { get; set; }
}
</code></pre>
<h3 id="partial-updates">Partial Updates<a class="header-anchor" href="javascript:;" onclick="location.hash='#partial-updates'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>The one thing we have to look out for if we implement our Update APIs with <code>IPatchDb&lt;T&gt;</code> Partial Updates is that all properties
other than the Primary Key should be nullable. This isn't required when implementing Update APIs with <code>IUpdateDb&lt;T&gt;</code>
which sends full updates of every property per request.</p>
<h3 id="custom-fields">Custom Fields<a class="header-anchor" href="javascript:;" onclick="location.hash='#custom-fields'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>Most of the functionality available to APIs can be enabled using <a href="https://docs.servicestack.net/locode/declarative">declarative attributes</a>,
In this case we're making usage of the <code>[Input]</code> <a href="https://docs.servicestack.net/locode/declarative#ui-metadata-attributes">UI Attribute</a>
to customize which UI Control is used to render the property in ServiceStack <a href="/auto-ui">Auto UIs</a>.</p>
<p>The <a href="https://docs.servicestack.net/vue/autoform">Auto Form Components</a> only render Input UI Components for .NET Types
where their exists a HTML Input Element for it. Since there's no HTML Input element that edits collections natively
we'll need to specify which Custom Vue Component to use, which in that case will use the <a href="https://docs.servicestack.net/vue/taginput">TagInput Component</a>
to edit <code>List&lt;string&gt;</code> properties:</p>
<pre><code class="language-csharp">public class UpdateCategory : IPatchDb&lt;Category&gt;, IReturn&lt;Category&gt;
{
    [Input(Type = &quot;tag&quot;), FieldCss(Field = &quot;col-span-12&quot;)]
    public List&lt;string&gt;? Sizes { get; set; }

    [Input(Type = &quot;tag&quot;), FieldCss(Field = &quot;col-span-12&quot;)]
    public List&lt;string&gt;? Temperatures { get; set; }

    [Input(Type = &quot;file&quot;), UploadTo(&quot;products&quot;)]
    public string? ImageUrl { get; set; }
    //...
}
</code></pre>
<p>Whilst <code>[Input(Type=&quot;file&quot;)]</code> specifies to use the HTML File Input to populate the <code>ImageUrl</code> property with the path to
the uploaded file that's handled by the <code>[UploadTo(&quot;products&quot;)]</code> <a href="https://docs.servicestack.net/locode/files-overview">Managed File Upload Location</a>
defined in <a href="https://github.com/NetCoreApps/CoffeeShop/blob/main/CoffeeShop/Configure.AppHost.cs">Configure.AppHost.cs</a>:</p>
<pre><code class="language-csharp">var wwwrootVfs = GetVirtualFileSource&lt;FileSystemVirtualFiles&gt;();
Plugins.Add(new FilesUploadFeature(
    new UploadLocation(&quot;products&quot;, wwwrootVfs, allowExtensions:FileExt.WebImages,
        resolvePath: ctx =&gt; $&quot;/products/{ctx.FileName}&quot;))
));
</code></pre>
<h2 id="locode-auto-ui">Locode Auto UI<a class="header-anchor" href="javascript:;" onclick="location.hash='#locode-auto-ui'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>A nice UX touch we can add to our UIs is to give each Table visual icons to better describe what they're for which we
can do by annotating them with SVGs in <a href="https://github.com/NetCoreApps/CoffeeShop/blob/main/CoffeeShop.ServiceModel/Icons.cs">Icons.cs</a>:</p>
<pre><code class="language-csharp">[Icon(Svg = Icons.Category)]
public class Category { ... }

[Icon(Svg = Icons.Option)]
public class Option { ... }

[Icon(Svg = Icons.OptionQuantity)]
public class OptionQuantity { ... }

[Icon(Svg = Icons.Product)]
public class Product { ... }
</code></pre>
<p>Where it will now show up next to each Table in <a href="https://docs.servicestack.net/locode/">Locode's CRUD UI</a> accessible at:</p>
<h3 class="not-prose text-center pb-8">
    <a class="text-4xl text-blue-600 hover:underline" href="https://localhost:5001/locode/">https://localhost:5001/locode/</a>
</h3>
<p>Which we can login with the <code>admin@email.com</code> user and default <code>p@55wOrd</code> created in <a href="https://github.com/NetCoreApps/CoffeeShop/blob/f00d4e5d3edd3dd23e325d1899e0078db025204a/CoffeeShop/Configure.AuthRepository.cs#L44">Configure.AuthRepository.cs</a>.</p>
<div class="shadow rounded-sm"><p><a href="/img/posts/building-typechat-coffeeshop-modelling/query-products.png"><img src="/img/posts/building-typechat-coffeeshop-modelling/query-products.png" alt="" /></a></p>
</div>
<p>So without having needing to write any implementation, Locode provides us with a full CRUD UI generated from your APIs typed
Request DTOs that's used to render all UI Forms using Vue <a href="https://docs.servicestack.net/vue/autoform">Auto Form Components</a>,
which we can see makes use of our customizations with <code>Sizes</code> and <code>Temperatures</code> properties managed by <strong>full-width</strong> <code>Tag</code> Input components
and <code>ImageUrl</code> managed by the <a href="https://docs.servicestack.net/vue/fileinput">FileInput Component</a>:</p>
<div class="shadow rounded-sm"><p><a href="/img/posts/building-typechat-coffeeshop-modelling/update-category.png"><img src="/img/posts/building-typechat-coffeeshop-modelling/update-category.png" alt="" /></a></p>
</div>
<p>And because we have <a href="https://github.com/NetCoreApps/CoffeeShop/blob/f00d4e5d3edd3dd23e325d1899e0078db025204a/CoffeeShop/Configure.AutoQuery.cs#L13">Crud Events registered</a>
our UI Forms also shows the <a href="https://docs.servicestack.net/autoquery/audit-log">AutoQuery CRUD Executable Audit Log</a> to be able to track and view
all edits made to each record through our AutoQuery APIs.</p>
<h2 id="custom-admin-ui">Custom Admin UI<a class="header-anchor" href="javascript:;" onclick="location.hash='#custom-admin-ui'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>Locode is a great way to enable an instant Management UI for backend developers or employees to browse and manage your Apps
data, and whilst it offers a <a href="https://docs.servicestack.net/locode/custom-overview">lot of customizability</a> it's not as
customizable as a Bespoke UI.</p>
<p>Fortunately as Locode is built on ServiceStack's <a href="https://servicestack.net/vue/">Vue Components</a> we can reuse the same
components to quickly build Custom Admin UIs:</p>
<div class="py-8 max-w-7xl mx-auto px-4 sm:px-6">
    <lite-youtube class="w-full mx-4 my-4" width="560" height="315" videoid="wlRA4_owEsc" style="background-image: url('https://img.youtube.com/vi/wlRA4_owEsc/maxresdefault.jpg')"></lite-youtube>
</div>
<p>To get started quickly the <a href="https://blazor-vue.web-templates.io">blazor-vue</a> template includes a Client Admin example at:</p>
<ul>
<li><a href="https://blazor-vue.web-templates.io/admin/">/admin/</a> - <a href="https://github.com/NetCoreTemplates/blazor-vue/blob/main/MyApp/wwwroot/admin/index.html">/portal/index.html</a></li>
</ul>
<p>Whose sections of Vue Components can be replaced with our Models to create the CoffeeShop Admin UI:</p>
<pre><code class="language-js">const sections = {
    //...
    Categories: {
        type: 'Category',
        component: {
            template:`
            &lt;AutoQueryGrid :type=&quot;type&quot; selectedColumns=&quot;imageUrl,id,name,defaultSize,products&quot;
                    :headerTitles=&quot;{ imageUrl: ' ' }&quot; :canFilter=&quot;x =&gt; x != 'ImageUrl'&quot;&gt;
                &lt;template #imageUrl=&quot;{ imageUrl }&quot;&gt;
                    &lt;Icon :src=&quot;imageUrl&quot; class=&quot;w-8 h-8 rounded-full&quot; /&gt;
                &lt;/template&gt;
                &lt;template #id=&quot;{ id }&quot;&gt;{‎{id}‎}&lt;/template&gt;
                &lt;template #name=&quot;{ name }&quot;&gt;{‎{name}‎}&lt;/template&gt;
                &lt;template #description=&quot;{ description }&quot;&gt;{‎{description}‎}&lt;/template&gt;
                &lt;template #defaultSize=&quot;{ defaultSize }&quot;&gt;{‎{defaultSize}‎}&lt;/template&gt;
                &lt;template #products=&quot;{ products }&quot;&gt;{‎{ products.map(x =&gt; x.name).join(', ') }‎}&lt;/template&gt;
            &lt;/AutoQueryGrid&gt;`,
        },
    },
    Products: {
        type: 'Product',
        component: {
            template:`
            &lt;AutoQueryGrid :type=&quot;type&quot; selectedColumns=&quot;imageUrl,category,id,name,cost&quot;
                    :headerTitles=&quot;{ imageUrl: ' ' }&quot; :canFilter=&quot;x =&gt; x != 'ImageUrl'&quot;&gt;
                &lt;template #imageUrl=&quot;{ imageUrl }&quot;&gt;
                    &lt;Icon :src=&quot;imageUrl&quot; class=&quot;w-8 h-8 rounded-full&quot; /&gt;
                &lt;/template&gt;
                &lt;template #category=&quot;{ category }&quot;&gt;
                    &lt;a :href=&quot;'#Categories?edit=' + category.id&quot; class=&quot;flex text-indigo-600 hover:underline&quot;&gt;
                        &lt;icon :svg=&quot;getIcon('Categories')&quot; class=&quot;w-5 h-5 mr-1 shrink-0 text-indigo-600&quot;&gt;&lt;/icon&gt;
                        {‎{category.name}‎}
                    &lt;/a&gt;
                &lt;/template&gt;
                &lt;template #id=&quot;{ id }&quot;&gt;{‎{id}‎}&lt;/template&gt;
                &lt;template #name=&quot;{ name }&quot;&gt;{‎{name}‎}&lt;/template&gt;
                &lt;template #cost=&quot;{ cost }&quot;&gt;
                    &lt;preview-format :value=&quot;cost&quot; :format=&quot;Formats.currency&quot;&gt;&lt;/preview-format&gt;
                &lt;/template&gt;
            &lt;/AutoQueryGrid&gt;`,
            setup() {
                return { getIcon, Formats }
            }
        },
    },
    Options: {
        type: 'Option',
        component: {
            template:`&lt;AutoQueryGrid :type=&quot;type&quot; /&gt;`,
        },
    },
    OptionQuantities: {
        type: 'OptionQuantity',
        component: {
            template:`&lt;AutoQueryGrid :type=&quot;type&quot; /&gt;`,
        },
    },
}
</code></pre>
<p>Which gives us a similar Admin UI with the advantage of a completely customizable UI, which we make use of to implement
custom <a href="https://docs.servicestack.net/vue/autoquerygrid">AutoQueryGrid components</a> for <strong>Categories</strong> and <strong>Products</strong>
showing a customized view with just the columns we want, the order and format we want it in whilst <strong>Options</strong> and
<strong>OptionQuantities</strong> continue to use the default AutoQueryGrid components:</p>
<div class="shadow rounded-sm"><p><a href="/img/posts/building-typechat-coffeeshop-modelling/portal-products.png"><img src="/img/posts/building-typechat-coffeeshop-modelling/portal-products.png" alt="" /></a></p>
</div>
<h2 id="custom-ui-forms">Custom UI Forms<a class="header-anchor" href="javascript:;" onclick="location.hash='#custom-ui-forms'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>We're pretty close to a complete Admin UI with AutoQuery and AutoForm Components being able to implement most of the
standard UI Forms we need except it doesn't have auto support for managing Many-to-Many relationships like <code>CategoryOption</code>
table which we'll need to implement ourselves to be able to specify which Options a category of Products can have.</p>
<h3 id="implementing-many-to-many-categoryoption-admin-ui">Implementing Many to Many CategoryOption Admin UI<a class="header-anchor" href="javascript:;" onclick="location.hash='#implementing-many-to-many-categoryoption-admin-ui'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>The easier way to implement this functionality would be to have the UI call an API each time an <code>Option</code> was added or removed
to a <code>Category</code>. The problem with this approach is that it doesn't match the existing behavior where if a User <strong>cancels</strong>
a form they'd expect for none of their changes to be applied.</p>
<p>To implement the desired functionality we'll instead create a custom <code>UpdateCategory</code> implementation that also
handles any changes to <code>CategoryOption</code> using new <code>AddOptionIds</code> and <code>RemoveOptionIds</code> properties that we'll want
rendered as <strong>hidden</strong> inputs in our HTML Form with:</p>
<pre><code class="language-csharp">public class UpdateCategory : IPatchDb&lt;Category&gt;, IReturn&lt;Category&gt;
{
    public int Id { get; set; }
    public string? Name { get; set; }
    public string? Description { get; set; }
    [Input(Type = &quot;tag&quot;), FieldCss(Field = &quot;col-span-12&quot;)]
    public List&lt;string&gt;? Sizes { get; set; }
    [Input(Type = &quot;tag&quot;), FieldCss(Field = &quot;col-span-12&quot;)]
    public List&lt;string&gt;? Temperatures { get; set; }
    public string? DefaultSize { get; set; }
    public string? DefaultTemperature { get; set; }
    [Input(Type = &quot;file&quot;), UploadTo(&quot;products&quot;)]
    public string? ImageUrl { get; set; }

    [Input(Type = &quot;hidden&quot;)]
    public List&lt;int&gt;? AddOptionIds { get; set; }
 
    [Input(Type = &quot;hidden&quot;)]
    public List&lt;int&gt;? RemoveOptionIds { get; set; }
}
</code></pre>
<p>We can then provide a <a href="https://docs.servicestack.net/autoquery/rdbms#custom-autoquery-implementations">Custom AutoQuery Implementation</a>
in <a href="https://github.com/NetCoreApps/CoffeeShop/blob/main/CoffeeShop.ServiceInterface/CoffeeShopServices.cs">CoffeeShopServices.cs</a>
which AutoQuery will use instead of its own.</p>
<p>Where our custom implementation continues to utilize AutoQuery's Partial Update functionality if there's any changes to update,
as well as removing or adding any Options the user makes to the <code>Category</code>:</p>
<pre><code class="language-csharp">public class CoffeeShopServices : Service
{
    public IAutoQueryDb AutoQuery { get; set; }
    
    public async Task&lt;object&gt; Any(UpdateCategory request)
    {
        // Perform all RDBMS Updates within the same Transaction
        using var trans = Db.OpenTransaction();

        Category? response = null;
        var ignore = new[] { nameof(request.Id), nameof(request.AddOptionIds), nameof(request.RemoveOptionIds) };
        // Only call AutoQuery Update if there's something to update
        if (request.ToObjectDictionary().HasNonDefaultValues(ignoreKeys:ignore))
        {
            response = (Category) await AutoQuery.PartialUpdateAsync&lt;Category&gt;(request, Request, Db);
        }
        if (request.RemoveOptionIds?.Count &gt; 0)
        {
            await Db.DeleteAsync&lt;CategoryOption&gt;(x =&gt; x.CategoryId == request.Id &amp;&amp; request.RemoveOptionIds.Contains(x.OptionId));
        }
        if (request.AddOptionIds?.Count &gt; 0)
        {
            await Db.InsertAllAsync(request.AddOptionIds.Map(id =&gt; new CategoryOption { CategoryId = request.Id, OptionId = id }));
        }
        trans.Commit();

        response ??= request.ConvertTo&lt;Category&gt;();
        return response;
    }
}
</code></pre>
<p>We now need to implement the Custom UI that Adds/Removes Options from a Category which we'll do in a custom <code>CategoryOptions</code>
Vue Component that displays all the Category Options with a button to remove existing ones and a Select Input to
add non existing options.</p>
<p>The purpose of the component is to populate the <code>addOptionIds</code> field with Option Ids that should be added and <code>removeOptionIds</code>
with Ids to be removed, which updates the Request DTO of the parent Form Model with the <code>update:modelValue</code> event:</p>
<pre><code class="language-js">const CategoryOptions = {
    template:`
         &lt;div&gt;
            &lt;ul v-for=&quot;optionType in currentOptionTypes&quot;&gt;
                &lt;li class=&quot;py-1 flex justify-between&quot;&gt;
                    &lt;span&gt;
                        {‎{optionType}‎}
                    &lt;/span&gt;
                    &lt;span&gt;
                        &lt;svg class=&quot;w-6 h-6 text-red-600 hover:text-red-800 cursor-pointer&quot; @click=&quot;removeOption(optionType)&quot; xmlns='http://www.w3.org/2000/svg' width='1024' height='1024' viewBox='0 0 1024 1024'&gt;
                            &lt;title&gt;Remove Option&lt;/title&gt;
                            &lt;path fill='currentColor' d='M512 64a448 448 0 1 1 0 896a448 448 0 0 1 0-896zM288 512a38.4 38.4 0 0 0 38.4 38.4h371.2a38.4 38.4 0 0 0 0-76.8H326.4A38.4 38.4 0 0 0 288 512z'/&gt;
                        &lt;/svg&gt;
                    &lt;/span&gt;
                &lt;/li&gt; 
            &lt;/ul&gt;
            &lt;div class=&quot;flex justify-between items-center&quot;&gt;
                &lt;select-input class=&quot;flex-grow&quot; @change=&quot;addOption&quot; :values=&quot;['',...options.filter(x =&gt; !currentOptionTypes.includes(x.type)).map(x =&gt; x.type)]&quot;&gt;&lt;/select-input&gt;
                &lt;svg class=&quot;ml-2 w-6 h-6 text-green-600&quot; xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'&gt;
                    &lt;title&gt;Add Option&lt;/title&gt;
                    &lt;path fill='currentColor' d='M11 17h2v-4h4v-2h-4V7h-2v4H7v2h4v4Zm1 5q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22Z'/&gt;
                &lt;/svg&gt;            
            &lt;/div&gt;
         &lt;/div&gt;
    `,
    props:['type','id','modelValue'],
    emits:['update:modelValue'],
    setup(props, { emit }) {
        const client = useClient()
        const options = ref([])
        const model = props.modelValue

        model.addOptionIds ??= []
        model.removeOptionIds ??= []
        const origOptionIds = model.categoryOptions?.map(x =&gt; x.optionId) || []

        const currentOptionIds = computed(() =&gt; [...origOptionIds, ...model.addOptionIds]
            .filter(x =&gt; !model.removeOptionIds.includes(x)))
        const currentOptionTypes = computed(() =&gt;
            currentOptionIds.value.map(id =&gt; options.value.find(x =&gt; x.id === id)?.type).filter(x =&gt; !!x))

        function addOption(e) {
            const optionType = e.target.value
            if (!optionType) return
            const option = options.value.find(x =&gt; x.type === optionType)
            if (model.removeOptionIds.includes(option.id))
                model.removeOptionIds = model.removeOptionIds.filter(id =&gt; id !== option.id)
            else if (!model.addOptionIds.includes(option.id))
                model.addOptionIds.push(option.id)
            emit('update:modelValue', model)
        }
        function removeOption(optionType) {
            const option = options.value.find(x =&gt; x.type === optionType)
            if (model.addOptionIds.includes(option.id))
                model.addOptionIds = model.addOptionIds.filter(id =&gt; id !== option.id)
            else if (!model.removeOptionIds.includes(option.id))
                model.removeOptionIds.push(option.id)
        }

        onMounted(async () =&gt; {
            const api = await client.api(new QueryOptions({ orderBy:'id' }))
            options.value = api.response.results || []
            emit('update:modelValue', model)
        })

        return { options, addOption, removeOption, currentOptionTypes }
    }
}
</code></pre>
<p>Which is then attached to the AutoQueryGrid Form Components using its <code>&lt;template #formfooter&gt;</code> to include it in the
bottom of the Create and Edit Form Components:</p>
<pre><code class="language-js">const sections = {
    Categories: {
        type: 'Category',
        component: {
            components: { CategoryOptions },
            template:`
            &lt;AutoQueryGrid :type=&quot;type&quot; selectedColumns=&quot;imageUrl,id,name,defaultSize,products&quot;
                    :headerTitles=&quot;{ imageUrl: ' ' }&quot; :canFilter=&quot;x =&gt; x != 'ImageUrl'&quot;&gt;
                &lt;template #imageUrl=&quot;{ imageUrl }&quot;&gt;
                    &lt;Icon :src=&quot;imageUrl&quot; class=&quot;w-8 h-8 rounded-full&quot; /&gt;
                &lt;/template&gt;
                &lt;template #id=&quot;{ id }&quot;&gt;{‎{id}‎}&lt;/template&gt;
                &lt;template #name=&quot;{ name }&quot;&gt;{‎{name}‎}&lt;/template&gt;
                &lt;template #description=&quot;{ description }&quot;&gt;{‎{description}‎}&lt;/template&gt;
                &lt;template #defaultSize=&quot;{ defaultSize }&quot;&gt;{‎{defaultSize}‎}&lt;/template&gt;
                &lt;template #products=&quot;{ products }&quot;&gt;{‎{ products.map(x =&gt; x.name).join(', ') }‎}&lt;/template&gt;
                &lt;template #formfooter=&quot;{ form, type, apis, model, id, updateModel }&quot;&gt;
                    &lt;div class=&quot;w-1/2 mt-4 px-4 sm:px-6&quot;&gt;
                        &lt;h3 class=&quot;text-lg font-semibold&quot;&gt;Options&lt;/h3&gt;
                        &lt;CategoryOptions v-if=&quot;form === 'edit'&quot; :key=&quot;id&quot; :type=&quot;type&quot; :id=&quot;id&quot; v-model=&quot;model&quot; @update:modelValue=&quot;updateModel(model)&quot; /&gt;
                    &lt;/div&gt;
                &lt;/template&gt;                
            &lt;/AutoQueryGrid&gt;`,
        },
    },
    //...
}
</code></pre>
<p>With those finishing touches our back-end Admin UI is now complete which CoffeeShop owners can use to manage their entire database:</p>
<div class="shadow rounded-sm"><p><a href="/img/posts/building-typechat-coffeeshop-modelling/portal-update-category.png"><img src="/img/posts/building-typechat-coffeeshop-modelling/portal-update-category.png" alt="" /></a></p>
</div>
<h3 id="generate-typescript-schema">Generate TypeScript Schema<a class="header-anchor" href="javascript:;" onclick="location.hash='#generate-typescript-schema'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>One of the goals for our App's Database is to dynamically generating the TypeScript Schema for TypeChat to use
to translate Customers Orders into valid Cart Orders that our Application can process. ServiceStack does include functionality
to <a href="https://docs.servicestack.net/typescript-add-servicestack-reference">convert C# DTOs into TypeScript Types</a> except that's not
useful here as the <a href="https://github.com/microsoft/TypeChat/blob/main/examples/coffeeShop/src/coffeeShopSchema.ts">coffeeShopSchema.ts</a>
is primarily populated from data not C# Types.</p>
<p>Instead the most flexible option to be able to generate the schema is to use a templating language, luckily we have a
great option for this in <a href="https://sharpscript.net">#Script</a> which combines <a href="https://handlebarsjs.com">Handlebars</a> and
<a href="https://sharpscript.net/docs/expression-viewer">JavaScript Expression</a> syntax with tight
<a href="https://sharpscript.net/docs/script-net">integration with .NET</a> that we can develop quickly thanks to its
<a href="https://sharpscript.net/#exploratory-programming">Live Reloading</a> dev UX.</p>
<p>To utilize #Script we need to create a <code>ScriptContext</code> in C# with all the Data and functionality the template needs to
generate the prompt by adding script arguments for all the data in our App's database which is done in
<a href="https://github.com/NetCoreApps/CoffeeShop/blob/main/CoffeeShop.ServiceInterface/CoffeeShopPromptProvider.cs">CoffeeShopPromptProvider.cs</a>:</p>
<pre><code class="language-csharp">public class CoffeeShopPromptProvider : IPromptProvider
{
    public IDbConnectionFactory DbFactory { get; set; }
    public AppConfig Config { get; set; }

    public async Task&lt;string&gt; CreateSchemaAsync(TypeChatRequest request, CancellationToken token)
    {
        var file = new FileInfo(Config.CoffeeShop.GptPath.CombineWith(&quot;schema.ss&quot;));
        if (file == null)
            throw HttpError.NotFound($&quot;{Config.CoffeeShop.GptPath}/schema.ss not found&quot;);

        using var db = await DbFactory.OpenDbConnectionAsync(token: token);
        var categories = await db.LoadSelectAsync(db.From&lt;Category&gt;(), token:token);
        var options = await db.SelectAsync&lt;Option&gt;(token: token);
        var optionsMap = options.ToDictionary(x =&gt; x.Id);
        var optionQuantities = await db.SelectAsync&lt;OptionQuantity&gt;(token: token);

        var tpl = await file.ReadAllTextAsync(token: token);
        var context = new ScriptContext {
            Plugins = { new TypeScriptPlugin() }
        }.Init();

        var output = await new PageResult(context.OneTimePage(tpl))
        {
            Args =
            {
                [nameof(categories)] = categories,
                [nameof(options)] = options,
                [nameof(optionsMap)] = optionsMap,
                [nameof(optionQuantities)] = optionQuantities,
            },
        }.RenderScriptAsync(token: token);
        return output;
    }
    //...
}
</code></pre>
<p>With the only added functionality our schema makes use of are the simple helpers in
<a href="https://github.com/ServiceStack/ServiceStack/blob/main/ServiceStack/src/ServiceStack.Common/Script/Methods/TypeScriptMethods.cs">TypeScriptMethods.cs</a></p>
<pre><code class="language-csharp">public class TypeScriptPlugin : IScriptPlugin
{
    public void Register(ScriptContext context) =&gt; 
        context.ScriptMethods.Add(new TypeScriptMethods());
}

public class TypeScriptMethods : ScriptMethods
{
    public RawString tsUnionStrings(IEnumerable&lt;string&gt; strings) =&gt; new(
        StringUtils.Join(&quot; | &quot;, strings.Map(x =&gt; $&quot;'{x}'&quot;), lineBreak:108));

    public RawString tsUnionTypes(IEnumerable&lt;string&gt; strings) =&gt; new(
        StringUtils.Join(&quot; | &quot;, strings, lineBreak:108));
}
</code></pre>
<p>The populated <code>ScriptContext</code> is then used to execute the
<a href="https://github.com/NetCoreApps/CoffeeShop/blob/main/CoffeeShop/gpt/coffeeshop/schema.ss">gpt/coffeeshop/schema.ss</a> <strong>#Script</strong> template:</p>
<pre><code class="language-js">// The following is a schema definition for ordering lattes.

export interface Cart {
    items: (LineItem | UnknownText)[];
}

// Use this type for order items that match nothing else
export interface UnknownText {
    type: 'unknown',
    text: string; // The text that wasn't understood
}

export interface LineItem {
    type: 'lineitem',
    product: Product;
    quantity: number;
}

export type Product = {‎{categories.map(x =&gt; x.name) |&gt; tsUnionTypes}‎};

{‎{#each category in categories}‎}
export interface {‎{category.name}‎} {
    type: '{‎{category.name}‎}';
    name: {‎{ category.products.map(x =&gt; x.name.lower()) |&gt; tsUnionStrings }‎};
{‎{#if !category.temperatures.isEmpty() }‎}
    temperature?: {‎{category.temperatures.map(x =&gt; x.lower()) |&gt; tsUnionStrings}‎};{‎{category.defaultTemperature ? ` // The default is '${category.defaultTemperature.lower()}'`.raw() : ''}‎}
{‎{/if}‎}
{‎{#if !category.sizes.isEmpty() }‎}
    size?: {‎{category.sizes.map(x =&gt; x.lower()) |&gt; tsUnionStrings}‎};{‎{category.defaultSize ? ` // The default is '${category.defaultSize.lower()}'`.raw() : ''}‎}
{‎{/if}‎}
{‎{#if options.count &gt; 0}‎}
    options?: ({‎{ options.map(x =&gt; x.type) |&gt; tsUnionTypes }‎})[];
{‎{/if}‎}
}

{‎{/each}‎}

{‎{#each option in options}‎}
export interface {‎{option.type}‎} {
    type: '{‎{option.type}‎}';
    name: {‎{ option.names.map(x =&gt; x.lower()) |&gt; tsUnionStrings }‎};
{‎{#if option.allowQuantity}‎}
    optionQuantity?: OptionQuantity;
{‎{/if}‎}
}
{‎{/each}‎}

export type OptionQuantity = {‎{optionQuantities.map(x =&gt; x.name.lower()) |&gt; tsUnionStrings}‎} | number;
</code></pre>
<p>To generate our <a href="https://github.com/NetCoreApps/CoffeeShop/blob/main/CoffeeShop/gpt/coffeeshop/schema.ts">gpt/coffeeshop/schema.ts</a>
which is functionality equivalent to TypeChat's hand crafted <a href="https://github.com/microsoft/TypeChat/blob/main/examples/coffeeShop/src/coffeeShopSchema.ts">coffeeShopSchema.ts</a>:</p>
<pre><code class="language-ts">// The following is a schema definition for ordering lattes.

export interface Cart {
    items: (LineItem | UnknownText)[];
}

// Use this type for order items that match nothing else
export interface UnknownText {
    type: 'unknown',
    text: string; // The text that wasn't understood
}

export interface LineItem {
    type: 'lineitem',
    product: Product;
    quantity: number;
}

export type Product = BakeryProducts | LatteDrinks | EspressoDrinks | CoffeeDrinks;

export interface BakeryProducts {
    type: 'BakeryProducts';
    name: 'apple bran muffin' | 'blueberry muffin' | 'lemon poppy seed muffin' | 'bagel';
    options?: (BakeryOptions | BakeryPreparations | Milks | Sweeteners | Syrups | Toppings | Caffeines | LattePreparations | 
        Creamers)[];
}

export interface LatteDrinks {
    type: 'LatteDrinks';
    name: 'cappuccino' | 'flat white' | 'latte' | 'latte macchiato' | 'mocha' | 'chai latte';
    temperature?: 'iced' | 'warm' | 'hot' | 'extra hot'; // The default is 'hot'
    size?: 'short' | 'tall' | 'grande' | 'venti'; // The default is 'grande'
    options?: (BakeryOptions | BakeryPreparations | Milks | Sweeteners | Syrups | Toppings | Caffeines | LattePreparations | 
        Creamers)[];
}

export interface EspressoDrinks {
    type: 'EspressoDrinks';
    name: 'espresso' | 'lungo' | 'ristretto' | 'macchiato';
    temperature?: 'iced' | 'warm' | 'hot' | 'extra hot'; // The default is 'hot'
    size?: 'solo' | 'doppio' | 'triple' | 'quad'; // The default is 'doppio'
    options?: (BakeryOptions | BakeryPreparations | Milks | Sweeteners | Syrups | Toppings | Caffeines | LattePreparations | 
        Creamers)[];
}

export interface CoffeeDrinks {
    type: 'CoffeeDrinks';
    name: 'americano' | 'coffee';
    temperature?: 'iced' | 'warm' | 'hot' | 'extra hot'; // The default is 'hot'
    size?: 'short' | 'tall' | 'grande' | 'venti'; // The default is 'grande'
    options?: (BakeryOptions | BakeryPreparations | Milks | Sweeteners | Syrups | Toppings | Caffeines | LattePreparations | 
        Creamers)[];
}


export interface BakeryOptions {
    type: 'BakeryOptions';
    name: 'butter' | 'strawberry jam' | 'cream cheese';
    optionQuantity?: OptionQuantity;
}
export interface BakeryPreparations {
    type: 'BakeryPreparations';
    name: 'warmed' | 'cut in half';
}
export interface Milks {
    type: 'Milks';
    name: 'whole milk' | 'two percent milk' | 'nonfat milk' | 'coconut milk' | 'soy milk' | 'almond milk' | 'oat milk';
}
export interface Sweeteners {
    type: 'Sweeteners';
    name: 'equal' | 'honey' | 'splenda' | 'sugar' | 'sugar in the raw' | 'sweet n low';
    optionQuantity?: OptionQuantity;
}
export interface Syrups {
    type: 'Syrups';
    name: 'almond syrup' | 'buttered rum syrup' | 'caramel syrup' | 'cinnamon syrup' | 'hazelnut syrup' | 
        'orange syrup' | 'peppermint syrup' | 'raspberry syrup' | 'toffee syrup' | 'vanilla syrup';
    optionQuantity?: OptionQuantity;
}
export interface Toppings {
    type: 'Toppings';
    name: 'cinnamon' | 'foam' | 'ice' | 'nutmeg' | 'whipped cream' | 'water';
    optionQuantity?: OptionQuantity;
}
export interface Caffeines {
    type: 'Caffeines';
    name: 'regular' | 'two thirds caf' | 'half caf' | 'one third caf' | 'decaf';
    optionQuantity?: OptionQuantity;
}
export interface LattePreparations {
    type: 'LattePreparations';
    name: 'for here cup' | 'lid' | 'with room' | 'to go' | 'dry' | 'wet';
}
export interface Creamers {
    type: 'Creamers';
    name: 'whole milk creamer' | 'two percent milk creamer' | 'one percent milk creamer' | 'nonfat milk creamer' | 
        'coconut milk creamer' | 'soy milk creamer' | 'almond milk creamer' | 'oat milk creamer' | 
        'half and half' | 'heavy cream';
}

export type OptionQuantity = 'no' | 'light' | 'regular' | 'extra' | number;
</code></pre>
<h3 id="optimizing-typescript-schema-generation">Optimizing TypeScript Schema Generation<a class="header-anchor" href="javascript:;" onclick="location.hash='#optimizing-typescript-schema-generation'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>Whilst our schema is functionally equivalent to TypeChat's <a href="https://github.com/microsoft/TypeChat/blob/main/examples/coffeeShop/src/coffeeShopSchema.ts">coffeeShopSchema.ts</a>, we noticed that some
of the prompts were not returning the same desirable results. After several iterations of experimentation we learned
that several factors about the structure of the schema contributed to the effectiveness of the results.</p>
<p>For example the <code>CoffeeTemperature</code>, <code>CoffeeSize</code>, <code>EspressoSize</code> Types aren't just inert aliases and adds descriptive
context to the prompt. Likewise the proximity and order of the Types affects the strength of their relationships and
we were able to get more effective results by defining Options next to the Categories they apply to.</p>
<p>We applied both changes to our <a href="https://github.com/NetCoreApps/CoffeeShop/blob/main/CoffeeShop/gpt/coffeeshop/schema.ss">schema.ss</a>
which now looks like:</p>
<pre><code class="language-js">{‎{* Type Aliases *}‎}
{‎{ var coffeeTemperatures = ['Iced','Warm','Hot','Extra Hot'] }‎}
{‎{ var coffeeSizes        = ['Short','Tall','Grande','Venti'] }‎}
{‎{ var espressoSizes      = ['Solo','Doppio','Triple','Quad'] }‎}

// The following is a schema definition for ordering lattes.

export interface Cart {
    items: (LineItem | UnknownText)[];
}

// Use this type for order items that match nothing else
export interface UnknownText {
    type: 'unknown',
    text: string; // The text that wasn't understood
}

export interface LineItem {
    type: 'lineitem',
    product: Product;
    quantity: number;
}

export type Product = {‎{categories.map(x =&gt; x.name) |&gt; tsUnionTypes}‎};

{‎{ var generatedOptionTypes = [] }‎}
{‎{#each category in categories}‎}
export interface {‎{category.name}‎} {
    type: '{‎{category.name}‎}';
    name: {‎{ category.products.map(x =&gt; x.name.lower()) |&gt; tsUnionStrings }‎};
{‎{#if coffeeTemperatures.equivalentTo(category.temperatures) }‎}
    temperature?: CoffeeTemperature;{‎{category.defaultTemperature ? `  // The default is '${category.defaultTemperature.lower()}'`.raw() : ''}‎}
{‎{else if !category.temperatures.isEmpty() }‎}
    temperature?: {‎{category.temperatures.map(x =&gt; x.lower()) |&gt; tsUnionStrings}‎};{‎{category.defaultTemperature ? `  // The default is '${category.defaultTemperature.lower()}'`.raw() : ''}‎}
{‎{/if}‎}
{‎{#if coffeeSizes.equivalentTo(category.sizes) }‎}
    size?: CoffeeSize;{‎{category.defaultSize ? `  // The default is '${category.defaultSize.lower()}'`.raw() : ''}‎}
{‎{else if espressoSizes.equivalentTo(category.sizes) }‎}
    size?: EspressoSize;{‎{category.defaultSize ? `  // The default is '${category.defaultSize.lower()}'`.raw() : ''}‎}
{‎{else if !category.sizes.isEmpty() }‎}
    size?: {‎{category.sizes.map(x =&gt; x.lower()) |&gt; tsUnionStrings}‎};{‎{category.defaultSize ? `  // The default is '${category.defaultSize.lower()}'`.raw() : ''}‎}
{‎{/if}‎}
{‎{#if options.count &gt; 0}‎}
    options?: ({‎{ options.map(x =&gt; x.type) |&gt; tsUnionTypes }‎})[];
{‎{/if}‎}
}

{‎{ var options = category.categoryOptions.map(x =&gt; optionsMap[x.optionId]) }‎}
{‎{#each option in options.where(x =&gt; !generatedOptionTypes.contains(x.type)) }‎}
{‎{ generatedOptionTypes.push(option.type) |&gt; ignore }‎}
export interface {‎{option.type}‎} {
    type: '{‎{option.type}‎}';
    name: {‎{ option.names.map(x =&gt; x.lower()) |&gt; tsUnionStrings }‎};
{‎{#if option.allowQuantity}‎}
    optionQuantity?: OptionQuantity;
{‎{/if}‎}
}
{‎{/each}‎}

{‎{/each}‎}

export type CoffeeTemperature = {‎{coffeeTemperatures.map(x =&gt; x.lower()) |&gt; tsUnionStrings}‎};

export type CoffeeSize = {‎{coffeeSizes.map(x =&gt; x.lower()) |&gt; tsUnionStrings}‎};

export type EspressoSize = {‎{espressoSizes.map(x =&gt; x.lower()) |&gt; tsUnionStrings}‎};

export type OptionQuantity = {‎{optionQuantities.map(x =&gt; x.name.lower()) |&gt; tsUnionStrings}‎} | number;
</code></pre>
<p>To generate our restructured and more effective resulting Schema:</p>
<pre><code class="language-typescript">// The following is a schema definition for ordering lattes.

export interface Cart {
    items: (LineItem | UnknownText)[];
}

// Use this type for order items that match nothing else
export interface UnknownText {
    type: 'unknown',
    text: string; // The text that wasn't understood
}

export interface LineItem {
    type: 'lineitem',
    product: Product;
    quantity: number;
}

export type Product = BakeryProducts | LatteDrinks | EspressoDrinks | CoffeeDrinks;

export interface BakeryProducts {
    type: 'BakeryProducts';
    name: 'apple bran muffin' | 'blueberry muffin' | 'lemon poppy seed muffin' | 'bagel';
    options?: (BakeryOptions | BakeryPreparations | Milks | Sweeteners | Syrups | Toppings | Caffeines | LattePreparations |
        Creamers)[];
}


export interface BakeryOptions {
    type: 'BakeryOptions';
    name: 'butter' | 'strawberry jam' | 'cream cheese';
    optionQuantity?: OptionQuantity;
}

export interface BakeryPreparations {
    type: 'BakeryPreparations';
    name: 'warmed' | 'cut in half';
}

export interface LatteDrinks {
    type: 'LatteDrinks';
    name: 'cappuccino' | 'flat white' | 'latte' | 'latte macchiato' | 'mocha' | 'chai latte';
    temperature?: CoffeeTemperature;  // The default is 'hot'
    size?: CoffeeSize;  // The default is 'grande'
    options?: (BakeryOptions | BakeryPreparations | Milks | Sweeteners | Syrups | Toppings | Caffeines | LattePreparations |
        Creamers)[];
}


export interface Milks {
    type: 'Milks';
    name: 'whole milk' | 'two percent milk' | 'nonfat milk' | 'coconut milk' | 'soy milk' | 'almond milk' | 'oat milk';
}

export interface Sweeteners {
    type: 'Sweeteners';
    name: 'equal' | 'honey' | 'splenda' | 'sugar' | 'sugar in the raw' | 'sweet n low';
    optionQuantity?: OptionQuantity;
}

export interface Syrups {
    type: 'Syrups';
    name: 'almond syrup' | 'buttered rum syrup' | 'caramel syrup' | 'cinnamon syrup' | 'hazelnut syrup' |
        'orange syrup' | 'peppermint syrup' | 'raspberry syrup' | 'toffee syrup' | 'vanilla syrup';
    optionQuantity?: OptionQuantity;
}

export interface Toppings {
    type: 'Toppings';
    name: 'cinnamon' | 'foam' | 'ice' | 'nutmeg' | 'whipped cream' | 'water';
    optionQuantity?: OptionQuantity;
}

export interface Caffeines {
    type: 'Caffeines';
    name: 'regular' | 'two thirds caf' | 'half caf' | 'one third caf' | 'decaf';
    optionQuantity?: OptionQuantity;
}

export interface LattePreparations {
    type: 'LattePreparations';
    name: 'for here cup' | 'lid' | 'with room' | 'to go' | 'dry' | 'wet';
}

export interface EspressoDrinks {
    type: 'EspressoDrinks';
    name: 'espresso' | 'lungo' | 'ristretto' | 'macchiato';
    temperature?: CoffeeTemperature;  // The default is 'hot'
    size?: EspressoSize;  // The default is 'doppio'
    options?: (BakeryOptions | BakeryPreparations | Milks | Sweeteners | Syrups | Toppings | Caffeines | LattePreparations |
        Creamers)[];
}


export interface Creamers {
    type: 'Creamers';
    name: 'whole milk creamer' | 'two percent milk creamer' | 'one percent milk creamer' | 'nonfat milk creamer' |
        'coconut milk creamer' | 'soy milk creamer' | 'almond milk creamer' | 'oat milk creamer' |
        'half and half' | 'heavy cream';
}

export interface CoffeeDrinks {
    type: 'CoffeeDrinks';
    name: 'americano' | 'coffee';
    temperature?: CoffeeTemperature;  // The default is 'hot'
    size?: CoffeeSize;  // The default is 'grande'
    options?: (BakeryOptions | BakeryPreparations | Milks | Sweeteners | Syrups | Toppings | Caffeines | LattePreparations |
        Creamers)[];
}


export type CoffeeTemperature = 'iced' | 'warm' | 'hot' | 'extra hot';

export type CoffeeSize = 'short' | 'tall' | 'grande' | 'venti';

export type EspressoSize = 'solo' | 'doppio' | 'triple' | 'quad';

export type OptionQuantity = 'no' | 'light' | 'regular' | 'extra' | number;
</code></pre>
<p>As prompt engineering is more an Art than a Science it took several iterations of experimentation across multiple prompts
to be able to measure the effectiveness of different changes, as such it was important to be able to modify and test
prompts quickly which generating prompts with <strong>#Script</strong> lets us do as we could make changes to the
<a href="https://github.com/NetCoreApps/CoffeeShop/blob/main/CoffeeShop/gpt/coffeeshop/schema.ss">schema.ss</a> template and
get immediate feedback of their efficacy whilst the App was running.</p>
<h2 id="part-2">Part 2<a class="header-anchor" href="javascript:;" onclick="location.hash='#part-2'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>Check out <a href="/posts/building-typechat-coffeeshop-gpt">Part 2</a> which covers the different options and challenges for using this
schema to create a functional Voice Activated CoffeeShop in .NET that utilizes different Speech-to-Text and GPT Providers.</p>

                </div>
            </div>
        </article>
</div>

<div id="comments" data-post="PostComments" class="my-48"></div>

        <div class="bg-gray-50 py-20">
            <div class="max-w-3xl mx-auto">
                <div class="flex justify-between">
                    <div>
                            <a href="posts/author/demis-bellot"><img class="w-20 h-20 rounded-full text-cyan-600" src="/img/authors/demis.jpg"></a>

                        <div class="mt-2 font-medium text-2xl">
                            Written by Demis Bellot
                        </div>
                        <div class="text-gray-600">
                            Father of 3 when not deving @ servicestack.net
                        </div>
                    </div>
                    <div class="flex items-end">
            <ul role="list" class="flex">
                    <li>
                        <a title="Follow on Twitter" class="mr-1 group flex text-sm font-medium text-zinc-800 transition hover:text-indigo-500 dark:text-zinc-200 dark:hover:text-indigo-500" href="https://twitter.com/demisbellot">
                            <svg viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6 flex-none text-zinc-500 fill-zinc-500 transition group-hover:fill-indigo-500">
                                <path d="M20.055 7.983c.011.174.011.347.011.523 0 5.338-3.92 11.494-11.09 11.494v-.003A10.755 10.755 0 0 1 3 18.186c.308.038.618.057.928.058a7.655 7.655 0 0 0 4.841-1.733c-1.668-.032-3.13-1.16-3.642-2.805a3.753 3.753 0 0 0 1.76-.07C5.07 13.256 3.76 11.6 3.76 9.676v-.05a3.77 3.77 0 0 0 1.77.505C3.816 8.945 3.288 6.583 4.322 4.737c1.98 2.524 4.9 4.058 8.034 4.22a4.137 4.137 0 0 1 1.128-3.86A3.807 3.807 0 0 1 19 5.274a7.657 7.657 0 0 0 2.475-.98c-.29.934-.9 1.729-1.713 2.233A7.54 7.54 0 0 0 22 5.89a8.084 8.084 0 0 1-1.945 2.093Z"></path>
                            </svg>
                        </a>
                    </li>
                    <li>
                        <a title="Follow on threads.net" class="mr-1 group flex text-sm font-medium text-zinc-800 transition hover:text-indigo-500 dark:text-zinc-200 dark:hover:text-indigo-500" href="https://threads.net/@demisbellot">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 flex-none text-zinc-500 fill-zinc-500 transition group-hover:fill-indigo-500" width="24" height="24" viewBox="0 0 24 24">
                                <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7.5c-1.333-3-3.667-4.5-7-4.5c-5 0-8 2.5-8 9s3.5 9 8 9s7-3 7-5s-1-5-7-5c-2.5 0-3 1.25-3 2.5C9 15 10 16 11.5 16c2.5 0 3.5-1.5 3.5-5s-2-4-3-4s-1.833.333-2.5 1"/>
                            </svg>
                        </a>
                    </li>
                    <li>
                        <a title="Follow on GitHub" class="mr-1 group flex text-sm font-medium text-zinc-800 transition hover:text-indigo-500 dark:text-zinc-200 dark:hover:text-indigo-500" href="https://github.com/mythz">
                            <svg viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6 flex-none text-zinc-500 fill-zinc-500 transition group-hover:fill-indigo-500">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C6.475 2 2 6.588 2 12.253c0 4.537 2.862 8.369 6.838 9.727.5.09.687-.218.687-.487 0-.243-.013-1.05-.013-1.91C7 20.059 6.35 18.957 6.15 18.38c-.113-.295-.6-1.205-1.025-1.448-.35-.192-.85-.667-.013-.68.788-.012 1.35.744 1.538 1.051.9 1.551 2.338 1.116 2.912.846.088-.666.35-1.115.638-1.371-2.225-.256-4.55-1.14-4.55-5.062 0-1.115.387-2.038 1.025-2.756-.1-.256-.45-1.307.1-2.717 0 0 .837-.269 2.75 1.051.8-.23 1.65-.346 2.5-.346.85 0 1.7.115 2.5.346 1.912-1.333 2.75-1.05 2.75-1.05.55 1.409.2 2.46.1 2.716.637.718 1.025 1.628 1.025 2.756 0 3.934-2.337 4.806-4.562 5.062.362.32.675.936.675 1.897 0 1.371-.013 2.473-.013 2.82 0 .268.188.589.688.486a10.039 10.039 0 0 0 4.932-3.74A10.447 10.447 0 0 0 22 12.253C22 6.588 17.525 2 12 2Z"></path>
                            </svg>
                        </a>
                    </li>
                    <li>
                        <a title="Email Demis Bellot" href="mailto:demis@servicestack.com" class="mr-1 group flex text-sm font-medium text-zinc-800 transition hover:text-indigo-500 dark:text-zinc-200 dark:hover:text-indigo-500">
                            <svg class="h-6 w-6 flex-none text-zinc-500 fill-zinc-500 transition group-hover:fill-indigo-500" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M4 20q-.825 0-1.413-.588T2 18V6q0-.825.588-1.413T4 4h16q.825 0 1.413.588T22 6v12q0 .825-.588 1.413T20 20H4Zm8-7L4 8v10h16V8l-8 5Zm0-2l8-5H4l8 5ZM4 8V6v12V8Z"/></svg>
                        </a>
                    </li>
            </ul>
                    </div>
                </div>

                <div class="mt-4 border-t">
                    <div class="py-8 text-lg text-gray-700 font-medium">
                        More from Demis Bellot
                    </div>
                    <div class="grid grid-cols-2 gap-8">
                            <div>
                                <div class="flex flex-col overflow-hidden">
                                    <div class="flex-shrink-0">
                                        <a href="posts/ai-server-2025-04">
                                            <img class="h-48 w-full object-cover" src="./img/posts/ai-server/bg.webp" alt="">
                                        </a>
                                    </div>
                                    <div class="flex flex-1 flex-col justify-between bg-white dark:bg-black p-6">
                                        <div class="flex-1">
                                            <p class="text-sm font-medium text-indigo-600 dark:text-indigo-300">
                                                Article
                                            </p>
                                            <a href="posts/ai-server-2025-04" class="mt-2 block">
                                                <p class="text-xl font-semibold text-gray-900 dark:text-gray-50 whitespace-nowrap overflow-hidden text-ellipsis" title="AI Server - April 2025 Update">
                                                    AI Server - April 2025 Update
                                                </p>
                                                <p class="mt-3 text-base text-gray-500">New SOTA LLMs added, support for thinking responses, Ollama Vision Models &amp; Generate API</p>
                                            </a>
                                        </div>
                                        <div class="mt-6 flex items-center">
                                            <div class="flex-shrink-0">
                                                <a href="">
                                                    <span class="sr-only">Demis Bellot</span>
                                                    <img class="h-10 w-10 rounded-full" src="/img/authors/demis.jpg" alt="AI Server - April 2025 Update background">
                                                </a>
                                            </div>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-gray-900">
                                                        <a href="posts/author/demis-bellot" class="hover:underline">Demis Bellot</a>
                                                </p>
                                                <div class="flex space-x-1 text-sm text-gray-500">
                                                    <time datetime="2025-04-24T00:00:00.0000000">April 24, 2025</time>
                                                    <span aria-hidden="true">&middot;</span>
                                                    <span>4 min read</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div>
                                <div class="flex flex-col overflow-hidden">
                                    <div class="flex-shrink-0">
                                        <a href="posts/identityauth-claims-roles">
                                            <img class="h-48 w-full object-cover" src="./img/posts/identityauth-claims-roles/bg.webp" alt="">
                                        </a>
                                    </div>
                                    <div class="flex flex-1 flex-col justify-between bg-white dark:bg-black p-6">
                                        <div class="flex-1">
                                            <p class="text-sm font-medium text-indigo-600 dark:text-indigo-300">
                                                Article
                                            </p>
                                            <a href="posts/identityauth-claims-roles" class="mt-2 block">
                                                <p class="text-xl font-semibold text-gray-900 dark:text-gray-50 whitespace-nowrap overflow-hidden text-ellipsis" title="Complete Admin UI Management for Identity Claims and Roles">
                                                    Complete Admin UI Management for Identity Claims and Roles
                                                </p>
                                                <p class="mt-3 text-base text-gray-500">With support for adding Roles and User and Role Claims, the built-in Admin UI now offers complete Identity Auth management</p>
                                            </a>
                                        </div>
                                        <div class="mt-6 flex items-center">
                                            <div class="flex-shrink-0">
                                                <a href="">
                                                    <span class="sr-only">Demis Bellot</span>
                                                    <img class="h-10 w-10 rounded-full" src="/img/authors/demis.jpg" alt="Complete Admin UI Management for Identity Claims and Roles background">
                                                </a>
                                            </div>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-gray-900">
                                                        <a href="posts/author/demis-bellot" class="hover:underline">Demis Bellot</a>
                                                </p>
                                                <div class="flex space-x-1 text-sm text-gray-500">
                                                    <time datetime="2025-04-17T00:00:00.0000000">April 17, 2025</time>
                                                    <span aria-hidden="true">&middot;</span>
                                                    <span>2 min read</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div>
                                <div class="flex flex-col overflow-hidden">
                                    <div class="flex-shrink-0">
                                        <a href="posts/analytics">
                                            <img class="h-48 w-full object-cover" src="./img/posts/analytics/bg.webp" alt="">
                                        </a>
                                    </div>
                                    <div class="flex flex-1 flex-col justify-between bg-white dark:bg-black p-6">
                                        <div class="flex-1">
                                            <p class="text-sm font-medium text-indigo-600 dark:text-indigo-300">
                                                Article
                                            </p>
                                            <a href="posts/analytics" class="mt-2 block">
                                                <p class="text-xl font-semibold text-gray-900 dark:text-gray-50 whitespace-nowrap overflow-hidden text-ellipsis" title="In Depth and Interactive API Analytics available to all ServiceStack Apps">
                                                    In Depth and Interactive API Analytics available to all ServiceStack Apps
                                                </p>
                                                <p class="mt-3 text-base text-gray-500">Comprehensive and Interactive API Analytics in Admin UI offering deep insights into API usage, performance, users, API Keys &amp; IPs.</p>
                                            </a>
                                        </div>
                                        <div class="mt-6 flex items-center">
                                            <div class="flex-shrink-0">
                                                <a href="">
                                                    <span class="sr-only">Demis Bellot</span>
                                                    <img class="h-10 w-10 rounded-full" src="/img/authors/demis.jpg" alt="In Depth and Interactive API Analytics available to all ServiceStack Apps background">
                                                </a>
                                            </div>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-gray-900">
                                                        <a href="posts/author/demis-bellot" class="hover:underline">Demis Bellot</a>
                                                </p>
                                                <div class="flex space-x-1 text-sm text-gray-500">
                                                    <time datetime="2025-04-15T00:00:00.0000000">April 15, 2025</time>
                                                    <span aria-hidden="true">&middot;</span>
                                                    <span>7 min read</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div>
                                <div class="flex flex-col overflow-hidden">
                                    <div class="flex-shrink-0">
                                        <a href="posts/llms-txt">
                                            <img class="h-48 w-full object-cover" src="./img/posts/llms-txt/bg.webp" alt="">
                                        </a>
                                    </div>
                                    <div class="flex flex-1 flex-col justify-between bg-white dark:bg-black p-6">
                                        <div class="flex-1">
                                            <p class="text-sm font-medium text-indigo-600 dark:text-indigo-300">
                                                Article
                                            </p>
                                            <a href="posts/llms-txt" class="mt-2 block">
                                                <p class="text-xl font-semibold text-gray-900 dark:text-gray-50 whitespace-nowrap overflow-hidden text-ellipsis" title="llms.txt and llms-full.txt support for Razor SSG and Razor Press">
                                                    llms.txt and llms-full.txt support for Razor SSG and Razor Press
                                                </p>
                                                <p class="mt-3 text-base text-gray-500">Free Razor SSG and Razor Press Static Site Templates now auto generates llms.txt and llms-full.txt files for Large Language Models</p>
                                            </a>
                                        </div>
                                        <div class="mt-6 flex items-center">
                                            <div class="flex-shrink-0">
                                                <a href="">
                                                    <span class="sr-only">Demis Bellot</span>
                                                    <img class="h-10 w-10 rounded-full" src="/img/authors/demis.jpg" alt="llms.txt and llms-full.txt support for Razor SSG and Razor Press background">
                                                </a>
                                            </div>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-gray-900">
                                                        <a href="posts/author/demis-bellot" class="hover:underline">Demis Bellot</a>
                                                </p>
                                                <div class="flex space-x-1 text-sm text-gray-500">
                                                    <time datetime="2025-03-03T00:00:00.0000000">March 3, 2025</time>
                                                    <span aria-hidden="true">&middot;</span>
                                                    <span>4 min read</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                    </div>
                </div>
            </div>
        </div>

<script type="module">
import { init } from "app.mjs"
init()
</script>

<link rel="stylesheet" href="css/highlight.css">
<script src="js/highlight.js"></script>
<script>hljs.highlightAll()</script>
<script src="js/lite-yt-embed.js"></script>
<script src="mjs/docs.mjs" type="module"></script>


<script type="module">
import { mount } from "app.mjs"

    const App = {
        setup() {
            function nav(url) {
                window.open(url)
            }
            return { nav }
        }
    }
    mount('#post', App)
</script>

    </main>
</div>

<footer class="bg-slate-200 dark:bg-black border-t border-slate-300 dark:border-gray-600 py-8 sm:py-12">
    <div class="max-w-screen-2xl mx-auto px-5">
        <div class="sm:flex sm:flex-wrap sm:-mx-4 md:py-4">
            <div class="px-4 sm:w-1/2 md:w-1/4 xl:w-1/6">
                <h5 class="block uppercase text-slate-500 font-semibold mb-4">Features</h5>
                <div>
                    <a href="https://servicestack.net/service-reference" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">ServiceStack Reference</a>
                    <a href="https://servicestack.net/creatorkit/" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">CreatorKit</a>
                    <a href="https://servicestack.net/litestream" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Litestream</a>
                    <a href="https://servicestack.net/ormlite" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">OrmLite</a>
                    <a href="https://servicestack.net/redis" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Redis</a>
                    <a href="https://servicestack.net/locode" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Locode</a>
                    <a href="https://www.jamstacks.net" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Jamstack</a>
                </div>
            </div>
            <div class="px-4 sm:w-1/2 md:w-1/4 xl:w-1/6 mt-8 sm:mt-0">
                <h5 class="block uppercase text-slate-500 font-semibold mb-4">Resources</h5>
                <div>
                    <a href="https://docs.servicestack.net" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Framework Docs</a>
                    <a href="https://forums.servicestack.net" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Customer Forums</a>
                    <a href="https://docs.servicestack.net/redis/" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">ServiceStack.Redis</a>
                    <a href="https://docs.servicestack.net/ormlite/" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">ServiceStack.OrmLite</a>
                    <a href="https://docs.servicestack.net/text" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">ServiceStack.Text</a>
                    <a href="https://docs.servicestack.net/aws" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">ServiceStack.Aws</a>
                    <a href="https://github.com/NetCoreApps/LiveDemos" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Live Demos</a>
                    <a href="https://servicestack.net/posts/" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Blog Archive</a>
                </div>
            </div>
            <div class="px-4 sm:w-1/2 md:w-1/4 xl:w-1/6 mt-8 md:mt-0">
                <h5 class="block uppercase text-slate-500 font-semibold mb-4">Learn</h5>
                <div>
                    <a href="https://docs.servicestack.net/why-servicestack" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Why ServiceStack</a>
                    <a href="https://docs.servicestack.net/architecture-overview" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Architecture</a>
                    <a href="https://docs.servicestack.net/explore-servicestack" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Explore ServiceStack</a>
                    <a href="https://docs.servicestack.net/api-first-development" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">API First Development</a>
                    <a href="https://docs.servicestack.net/service-complexity-and-dto-roles" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">The Simple POCO Life</a>
                    <a href="https://servicestack.net/training" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Training Services</a>
                </div>
            </div>
            <div class="px-4 sm:w-1/2 md:w-1/4 xl:w-1/6 mt-8 md:mt-0">
                <h5 class="block uppercase text-slate-500 font-semibold mb-4">About</h5>
                <div>
                    <a href="https://servicestack.net/support" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Support</a>
                    <a href="https://servicestack.net/whatsnew" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">What's New</a>
                    <a href="https://servicestack.net/#contact" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Contact Us</a>
                    <a href="https://servicestack.net/privacy" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Privacy</a>
                    <a href="https://servicestack.net/terms" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Terms</a>
                </div>
            </div>
            <div class="px-4 mt-4 flex justify-end">
                <div class="max-w-sm">
                    <div class="mx-auto">
                        <h5 class="block uppercase text-slate-500 font-semibold mb-4">Stay connected</h5>

                        <div class="mt-6 lg:mb-0 mb-6">
                            <a href="https://twitter.com/ServiceStack" class="inline-block bg-white dark:bg-gray-800 p-2 text-blue-400 shadow-lg font-normal items-center justify-center align-center rounded-full outline-none focus:outline-none mr-2">
                                <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M22.46 6c-.77.35-1.6.58-2.46.69c.88-.53 1.56-1.37 1.88-2.38c-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29c0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15c0 1.49.75 2.81 1.91 3.56c-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07a4.28 4.28 0 0 0 4 2.98a8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21C16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56c.84-.6 1.56-1.36 2.14-2.23Z"/></svg>
                            </a>
                            <a href="https://www.youtube.com/channel/UC0kXKGVU4NHcwNdDdRiAJSA" class="inline-block bg-white dark:bg-gray-800 p-2 text-red-600 shadow-lg font-normal items-center justify-center align-center rounded-full outline-none focus:outline-none mr-2">
                                <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M21.543 6.498C22 8.28 22 12 22 12s0 3.72-.457 5.502c-.254.985-.997 1.76-1.938 2.022C17.896 20 12 20 12 20s-5.893 0-7.605-.476c-.945-.266-1.687-1.04-1.938-2.022C2 15.72 2 12 2 12s0-3.72.457-5.502c.254-.985.997-1.76 1.938-2.022C6.107 4 12 4 12 4s5.896 0 7.605.476c.945.266 1.687 1.04 1.938 2.022zM10 15.5l6-3.5l-6-3.5v7z"/></svg>
                            </a>
                            <a href="https://github.com/ServiceStack" class="inline-block bg-white dark:bg-gray-800 p-2 text-slate-800 shadow-lg font-normal items-center justify-center align-center rounded-full outline-none focus:outline-none mr-2">
                                <svg class="h-6 w-6 dark:text-white" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33c.85 0 1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z"/></svg>
                            </a>
                        </div>
                    </div>
                    <div class="mt-8" data-mail="JoinMailingList" data-props="{ submitLabel:'Join our newsletter' }"></div>
                </div>
            </div>
        </div>

        <div class="sm:flex sm:flex-wrap sm:-mx-4 mt-6 pt-6 sm:mt-12 sm:pt-12 border-t dark:border-gray-700">
            <div class="sm:w-full px-4 md:w-1/6">
                <b>About ServiceStack</b>
            </div>
            <div class="px-4 sm:w-1/2 mt-4 md:mt-0 text-sm text-gray-600">
                ServiceStack started development in 2008 with the mission of creating a best-practices services framework
                with an emphasis on simplicity and speed, reducing the effort in creating and maintaining resilient
                message-based SOA Services and rich web apps like <a href="https://pvq.app">pvq</a>.

                <p class="pt-2">Copyright (c) ServiceStack Inc. 2024</p>
            </div>
            <div class="px-4 md:w-1/4 md:ml-auto mt-6 sm:mt-4 md:mt-0">
                <a href="https://servicestack.net/start"
                   class="bg-slate-800 text-white active:bg-slate-600 text-sm font-semibold uppercase px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150">
                    Get started
                </a>
            </div>
        </div>        
        
    </div>
</footer>

<script type="module">
import { mail } from 'https://creatorkit.servicestack.net/mjs/components/mail.mjs'
import { post } from 'https://creatorkit.servicestack.net/mjs/components/post.mjs'

mail('[data-mail]', { mailingLists:['MonthlyNewsletter'] })
post('[data-post]', {
    commentLink: { 
        href: '/community-rules',
        label: 'read the community rules'
    } 
})
</script>


<script type="module">
import { init } from "app.mjs"
init()
</script>



</body>
</html>