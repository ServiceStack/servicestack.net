<!doctype html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TZZ1VK3VGL"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date()); gtag('config', 'G-TZZ1VK3VGL');</script>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/svg" href="img/logo.svg">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="https://servicestack.net/feed.xml" />
    <title>Utilize C# Commands to build more robust and observable systems - ServiceStack</title>
    <base href="/" />
    <script>
    if (location.search === "?dark") localStorage.setItem('color-scheme','dark') 
    if (location.search === "?light") localStorage.removeItem('color-scheme') 
    const cls = document.querySelector('html').classList
    if (localStorage.getItem('color-scheme') === 'dark')
        cls.add('dark')
    else
        cls.remove('dark')
    </script>
    <link rel="stylesheet" href="css/app.css">

    <script type="importmap">
{
    "imports": {
        "app.mjs": "./mjs/app.mjs",
        "dtos.mjs": "./mjs/dtos.mjs",
        "vue": "./lib/mjs/vue.mjs",
        "@servicestack/client": "./lib/mjs/servicestack-client.mjs",
        "@servicestack/vue": "./lib/mjs/servicestack-vue.mjs",
        "highlight.mjs": "./lib/mjs/highlight.mjs",
        "core": "./js/core.mjs"
    }
}
</script>
    
    <meta name="twitter:site" content="@ServiceStack" />
    <meta name="twitter:creator" content="@demisbellot" />
    <meta name="twitter:card" content="summary" />
    <meta property="og:description" content="Learn how to build testable, robust observable systems with the new Commands Feature" />
    <meta property="og:url" content="https://servicestack.net/posts/commands-feature" />
    <meta property="og:title" content="Utilize C# Commands to build more robust and observable systems" />
    <meta property="og:image" content="./img/posts/commands-feature/bg.webp" />


</head>
<body class="bg-white dark:bg-black dark:text-white">
<header class="top-0 fixed z-50 h-14 bg-white dark:bg-black opacity-90 w-full shadow pr-3">
    <div class="w-full flex flex-wrap items-center">
        <div class="absolute z-10 top-2 left-2 sm:static flex-shrink flex-grow-0">
            <div class="cursor-pointer">
                <a class="navbar-brand flex items-center" href="./">
                    <svg class="w-8 h-8 sm:ml-2 sm:w-12 sm:h-12 text-gray-900 dark:text-gray-50" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path fill="currentColor" d="M10 6c1.544 1.76 2.276 4.15 2.217 6.61c3.968 1.67 9.924 6.12 11.181 12.39H28C26.051 14.31 14.918 6.77 10 6zm-2 7c4.67 4.913.81 11.582-4 12h18.97C21.5 18.289 11.95 13.533 8 13z"/></svg>
                    <span class="hidden sm:block text-2xl font-bold text-gray-900 dark:text-gray-50">ServiceStack</span>
                </a>
            </div>
        </div>
        <div class="flex flex-grow flex-shrink flex-nowrap justify-end items-center">
            <nav class="relative flex flex-grow leading-6 font-semibold text-slate-700 dark:text-slate-200">
                <ul class="flex flex-wrap items-center justify-end w-full m-0 pb-2 sm:pb-0">
                            <li class="relative flex flex-wrap just-fu-start m-0">
                                <a href="https://servicestack.net/blog" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400">
                                    Blog
                                </a>
                            </li>
                            <li class="relative flex flex-wrap just-fu-start m-0">
                                <a href="https://servicestack.net/posts/" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400">
                                    Archive
                                </a>
                            </li>
                            <li class="relative flex flex-wrap just-fu-start m-0">
                                <a href="https://servicestack.net/podcasts" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400">
                                    Podcasts
                                </a>
                            </li>
                    <li class="relative flex flex-wrap just-fu-start m-0">
                        <div data-component="DarkModeToggle" class="ml-2 w-10"></div>
                    </li>
                </ul>
            </nav>

        </div>
    </div>
</header>
<script type="module">
import { mountAll } from "app.mjs"
mountAll()
</script>


<div class="min-h-screen">
    <main role="main" class="pt-14">
        



<link rel="stylesheet" href="css/typography.css">
<link rel="stylesheet" href="css/lite-yt-embed.css">

<div class="container px-5 mb-32 mx-auto">
        <article class="mt-20">
            <h1 class="text-6xl md:text-7xl lg:text-8xl font-bold tracking-tighter leading-tight md:leading-none mb-12 text-center md:text-left">
                Utilize C# Commands to build more robust and observable systems
            </h1>
            <div class="flex flex-wrap justify-between">
                <div class="md:mb-12 flex items-center">
                        <a href="posts/author/demis-bellot"><img class="w-12 h-12 rounded-full mr-4 text-cyan-600" src="/img/authors/demis.jpg"></a>
                    <div class="flex flex-col">
                            <a class="text-xl font-semibold hover:underline" href="posts/author/demis-bellot">Demis Bellot</a>
            <ul role="list" class="flex">
                    <li>
                        <a title="Follow on Twitter" class="mr-1 group flex text-sm font-medium text-zinc-800 transition hover:text-indigo-500 dark:text-zinc-200 dark:hover:text-indigo-500" href="https://twitter.com/demisbellot">
                            <svg viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6 flex-none text-zinc-500 fill-zinc-500 transition group-hover:fill-indigo-500">
                                <path d="M20.055 7.983c.011.174.011.347.011.523 0 5.338-3.92 11.494-11.09 11.494v-.003A10.755 10.755 0 0 1 3 18.186c.308.038.618.057.928.058a7.655 7.655 0 0 0 4.841-1.733c-1.668-.032-3.13-1.16-3.642-2.805a3.753 3.753 0 0 0 1.76-.07C5.07 13.256 3.76 11.6 3.76 9.676v-.05a3.77 3.77 0 0 0 1.77.505C3.816 8.945 3.288 6.583 4.322 4.737c1.98 2.524 4.9 4.058 8.034 4.22a4.137 4.137 0 0 1 1.128-3.86A3.807 3.807 0 0 1 19 5.274a7.657 7.657 0 0 0 2.475-.98c-.29.934-.9 1.729-1.713 2.233A7.54 7.54 0 0 0 22 5.89a8.084 8.084 0 0 1-1.945 2.093Z"></path>
                            </svg>
                        </a>
                    </li>
                    <li>
                        <a title="Follow on threads.net" class="mr-1 group flex text-sm font-medium text-zinc-800 transition hover:text-indigo-500 dark:text-zinc-200 dark:hover:text-indigo-500" href="https://threads.net/@demisbellot">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 flex-none text-zinc-500 fill-zinc-500 transition group-hover:fill-indigo-500" width="24" height="24" viewBox="0 0 24 24">
                                <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7.5c-1.333-3-3.667-4.5-7-4.5c-5 0-8 2.5-8 9s3.5 9 8 9s7-3 7-5s-1-5-7-5c-2.5 0-3 1.25-3 2.5C9 15 10 16 11.5 16c2.5 0 3.5-1.5 3.5-5s-2-4-3-4s-1.833.333-2.5 1"/>
                            </svg>
                        </a>
                    </li>
                    <li>
                        <a title="Follow on GitHub" class="mr-1 group flex text-sm font-medium text-zinc-800 transition hover:text-indigo-500 dark:text-zinc-200 dark:hover:text-indigo-500" href="https://github.com/mythz">
                            <svg viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6 flex-none text-zinc-500 fill-zinc-500 transition group-hover:fill-indigo-500">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C6.475 2 2 6.588 2 12.253c0 4.537 2.862 8.369 6.838 9.727.5.09.687-.218.687-.487 0-.243-.013-1.05-.013-1.91C7 20.059 6.35 18.957 6.15 18.38c-.113-.295-.6-1.205-1.025-1.448-.35-.192-.85-.667-.013-.68.788-.012 1.35.744 1.538 1.051.9 1.551 2.338 1.116 2.912.846.088-.666.35-1.115.638-1.371-2.225-.256-4.55-1.14-4.55-5.062 0-1.115.387-2.038 1.025-2.756-.1-.256-.45-1.307.1-2.717 0 0 .837-.269 2.75 1.051.8-.23 1.65-.346 2.5-.346.85 0 1.7.115 2.5.346 1.912-1.333 2.75-1.05 2.75-1.05.55 1.409.2 2.46.1 2.716.637.718 1.025 1.628 1.025 2.756 0 3.934-2.337 4.806-4.562 5.062.362.32.675.936.675 1.897 0 1.371-.013 2.473-.013 2.82 0 .268.188.589.688.486a10.039 10.039 0 0 0 4.932-3.74A10.447 10.447 0 0 0 22 12.253C22 6.588 17.525 2 12 2Z"></path>
                            </svg>
                        </a>
                    </li>
                    <li>
                        <a title="Email Demis Bellot" href="mailto:demis@servicestack.com" class="mr-1 group flex text-sm font-medium text-zinc-800 transition hover:text-indigo-500 dark:text-zinc-200 dark:hover:text-indigo-500">
                            <svg class="h-6 w-6 flex-none text-zinc-500 fill-zinc-500 transition group-hover:fill-indigo-500" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M4 20q-.825 0-1.413-.588T2 18V6q0-.825.588-1.413T4 4h16q.825 0 1.413.588T22 6v12q0 .825-.588 1.413T20 20H4Zm8-7L4 8v10h16V8l-8 5Zm0-2l8-5H4l8 5ZM4 8V6v12V8Z"/></svg>
                        </a>
                    </li>
            </ul>
                    </div>
                </div>
                        <div data-component="pages/podcasts/AudioPlayer.mjs" 
                             data-props="{ id:'commands-feature', title:'Commands Feature', src:'https://media.servicestack.com/podcasts/commands-feature.mp3', beaconUrl:'https://servicestack.net/stats/podcast/record?name=commands-feature&amp;source=post&amp;version=8.8.1', variant:'compact' }"
                             class="mt-4 md:w-[450px] md:mt-0"></div>
                <div class="mb-4 max-w-sm" data-mail="JoinMailingList" data-props="{ submitLabel:'Join our newsletter' }"></div>
            </div>
            
            <div class="mb-8 md:mb-16 sm:mx-0">
                <div class="sm:mx-0">
                    <img src="./img/posts/commands-feature/bg.webp" alt="Utilize C# Commands to build more robust and observable systems Background" class="shadow-small">
                </div>
            </div>
            <div class="flex max-w-3xl mx-auto justify-between">
                <div>
                    <div class="mb-4 flex flex-wrap">
                        <a href="posts/tagged/commands" class="mr-2 text-xs leading-5 font-semibold bg-slate-400/10 rounded-full py-1 px-3 flex items-center space-x-2 hover:bg-slate-400/20 dark:highlight-white/5">commands</a>
                        <a href="posts/tagged/net8" class="mr-2 text-xs leading-5 font-semibold bg-slate-400/10 rounded-full py-1 px-3 flex items-center space-x-2 hover:bg-slate-400/20 dark:highlight-white/5">.net8</a>
                    </div>
                        <div class="max-w-3xl mx-auto">
                            <div class="mb-6 text-lg text-gray-500">
                                <time datetime="2024-07-03T00:00:00.0000000">July 3, 2024</time>
                                <span aria-hidden="true">&middot;</span>
                                <span>11 min read</span>
                            </div>
                        </div>
                </div>
                <div class="flex flex-grow-0">
                    <div data-post="PostVotes"></div>
                    <a href="javascript:;" onclick="document.location.hash='comments'" class="cursor-pointer" title="Jump to comments">
                        <svg class="ml-4 text-gray-700 mt-1 w-7 h-7" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill="currentColor" d="M3 11.2c0 .1 0 .1 0 0c0 .1 0 .1 0 0zM8.3 1C3.9 1 0 3.6 0 6.6c0 2 1.1 3.7 3 4.7s0 .1 0 .1c-.1 1.3-.9 1.7-.9 1.7L.3 14h2c2.5 0 4.3-1.1 5.1-1.9h.8c4.3 0 7.8-2.5 7.8-5.6S12.6 1 8.3 1zm-.1 10.1H7l-.2.2c-.5.5-1.6 1.4-3.3 1.7c.3-.5.5-1.1.5-2v-.3l-.3-.1C1.9 9.7 1 8.3 1 6.6C1 4.2 4.5 2 8.3 2C12 2 15 4 15 6.6c0 2.4-3.1 4.5-6.8 4.5z"/></svg>
                    </a>
                </div>
            </div>
            <div class="max-w-3xl mx-auto">
                <div id="post" class="prose lg:prose-xl max-w-none mb-32">
                    <p>Much of ServiceStack has been focused on providing a productive <a href="https://docs.servicestack.net/api-first-development">API First Development</a>
experience and adding value-added features around your System's external APIs, including:</p>
<ul>
<li><a href="https://docs.servicestack.net/add-servicestack-reference">Native end-to-end typed API integrations</a> to <strong>11 popular languages</strong></li>
<li>Built-in <a href="https://docs.servicestack.net/api-explorer">API Explorer</a> to discover, browse and invoke APIs</li>
<li>Instant CRUD UIs with <a href="https://docs.servicestack.net/autoquery/">Auto Query</a> and <a href="https://docs.servicestack.net/locode/">Locode</a></li>
<li>Custom CRUD UIs with <a href="https://blazor-gallery.jamstacks.net">Blazor components</a> and <a href="https://docs.servicestack.net/vue/">Vue Components</a></li>
</ul>
<p>As well as <a href="https://docs.servicestack.net/declarative-validation">Declarative Validation</a>, multiple <a href="https://docs.servicestack.net/auth/">Auth Integrations</a>
and other extensive <a href="https://docs.servicestack.net/locode/declarative">Declarative Features</a> to enhance your external facing APIs.</p>
<h3 id="internal-api-implementation">Internal API Implementation<a class="header-anchor" href="javascript:;" onclick="location.hash='#internal-api-implementation'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>Little attention has been given to internal implementations of APIs since it can use anything that fulfils its
service contract by returning the APIs populated Response DTO.</p>
<p>How code-bases are structured is largely a matter of developer preference, however we believe we've also been able
to add value in this area by introducing an appealing option with our new managed <strong>Commands</strong> Feature.</p>
<lite-youtube class="w-full mx-4 my-4" width="560" height="315" videoid="SXPdBHbncPc" playlabel="Use C# Commands to build robust and observable systems with Admin UI" style="background-image:url('https://img.youtube.com/vi/SXPdBHbncPc/maxresdefault.jpg')"></lite-youtube>
<h2 id="code-architecture">Code Architecture<a class="header-anchor" href="javascript:;" onclick="location.hash='#code-architecture'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>Ultimately nothing beats the simplicity of &quot;No Architecture&quot; by maintaining all logic within a Service Implementation
which just needs to call a few App dependencies to implement its functionality and return a populated Response DTO:</p>
<pre><code class="language-csharp">public object Any(MyRequest request) =&gt; new MyResponse { ... };
</code></pre>
<p>This is still the best option for small implementations where the Service is the only consumer of the logic that should
be run on the HTTP Worker Request Thread.</p>
<h4 id="when-to-restructure">When to restructure<a class="header-anchor" href="javascript:;" onclick="location.hash='#when-to-restructure'" aria-label="Permalink">&ZeroWidthSpace;</a></h4>
<p>The times when you may want to consider moving logic out of your Service into separate classes include:</p>
<ul>
<li><strong>Code Reuse</strong>: Make it easier to reuse your Service logic in other Services</li>
<li><strong>Complexity</strong>: Break down complex logic into smaller more manageable pieces</li>
<li><strong>Testability</strong>: Make it easier to test your Logic in isolation</li>
<li><strong>Observability</strong>: Make it easier to log and monitor</li>
<li><strong>Robustness</strong>: Make it easier to handle, retry and recover from errors</li>
<li><strong>Flexibility</strong>: Make it easier to run in parallel or in a different managed thread</li>
</ul>
<p>We'll look at how the new <strong>Commands Feature</strong> can help with these concerns.</p>
<h3 id="code-reuse">Code Reuse<a class="header-anchor" href="javascript:;" onclick="location.hash='#code-reuse'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>Following principles of YAGNI in doing the simplest thing that could possibly work, whenever we want to reuse logic
across Services we'd first start by moving it to an extension method on the dependency that it uses, e.g.</p>
<pre><code class="language-csharp">public static async Task&lt;List&lt;Contact&gt;&gt; GetActiveSubscribersAsync(
    this IDbConnection db, MailingList mailingList)
{        
    return await db.SelectAsync(db.From&lt;Contact&gt;(db.TableAlias(&quot;c&quot;))
        .Where(x =&gt; x.DeletedDate == null &amp;&amp; x.UnsubscribedDate == null &amp;&amp; 
            x.VerifiedDate != null &amp;&amp; (mailingList &amp; x.MailingLists) == mailingList)
        .WhereNotExists(db.From&lt;InvalidEmail&gt;()
            .Where&lt;Contact,InvalidEmail&gt;((c,e) =&gt; 
                e.EmailLower == Sql.TableAlias(c.EmailLower, &quot;c&quot;))
            .Select(x =&gt; x.Id))
    );
}
</code></pre>
<p>Which does a great job at encapsulating logic and making it reusable and readable:</p>
<pre><code class="language-csharp">foreach (var sub in await Db.GetActiveSubscribersAsync(MailingList.Newsletter)) {
    //...
}
</code></pre>
<p>Where it can be reused without referencing any external classes whilst also being easily discoverable via intellisense.</p>
<p>This works great for 1 or 2 dependencies, but becomes more cumbersome as the number of dependencies grows, e.g:</p>
<pre><code class="language-csharp">public static async Task&lt;List&lt;Contact&gt;&gt; GetActiveSubscribersAsync(
    this IDbConnection db, ILogger log, ICacheClient cache, MailingList mailingList)
</code></pre>
<p>In which the complexity of the extension method dependencies leaks and impacts all calling classes that need to include
them and also starts to impact its readability, e.g:</p>
<pre><code class="language-csharp">public class MyService(ILogger&lt;MyService&gt; log, ICacheClient cache, IDbConnection db) 
    : Service
{
    public object Any(MyRequest request)
    {
        var subs = await Db.GetActiveSubscribersAsync(log, cache, request.MailList);
    }
}
</code></pre>
<h3 id="refactoring-logic-into-separate-classes">Refactoring Logic into separate classes<a class="header-anchor" href="javascript:;" onclick="location.hash='#refactoring-logic-into-separate-classes'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>The solution to this is to refactor the logic into a separate class and leverage the IOC to inject the dependencies it needs,
fortunately with Primary Constructors this now requires minimal boilerplate code, e.g:</p>
<pre><code class="language-csharp">class MyLogic(ILogger&lt;MyService&gt; log, ICacheClient cache, IDbConnection db)
{
    //...
}
</code></pre>
<p>But it still requires manual registration adding additional complexity to
your Host project <code>Program.cs</code> or <a href="https://docs.servicestack.net/modular-startup">Modular Configurations</a> which needs to
manage registration for all these new logic classes, e.g:</p>
<pre><code class="language-csharp">builder.Services.AddTransient&lt;MyLogic&gt;();
</code></pre>
<h2 id="commands-feature">Commands Feature<a class="header-anchor" href="javascript:;" onclick="location.hash='#commands-feature'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>Which touches on the first benefit of the <strong>Commands Feature</strong> which like ServiceStack Services auto registers
all classes implementing the intentionally simple and impl-free <code>IAsyncCommand</code> interface, e.g:</p>
<pre><code class="language-csharp">public interface IAsyncCommand&lt;in T&gt;
{
    Task ExecuteAsync(T request);
}
</code></pre>
<p>Allowing for maximum flexibility in how to implement your logic classes, which are essentially encapsulated
units of logic with a single method to execute it, e.g:</p>
<pre><code class="language-csharp">public class AddTodoCommand(ILogger&lt;AddTodoCommand&gt; log, IDbConnection db) 
    : IAsyncCommand&lt;CreateTodo&gt;
{
    public async Task ExecuteAsync(CreateTodo request)
    {
        var newTodo = request.ConvertTo&lt;Todo&gt;();
        newTodo.Id = await db.InsertAsync(newTodo, selectIdentity:true);
        log.LogDebug(&quot;Created Todo {Id}: {Text}&quot;, newTodo.Id, newTodo.Text);
    }
}
</code></pre>
<p>Where we immediately get the benefits of code reuse, encapsulation, and readability without needing to manually
register and pollute your App's configuration with them.</p>
<p>By default Commands are registered as transient dependencies, but you can also register them with a different lifetime
scope using the <code>[Lifetime]</code> attribute, e.g:</p>
<pre><code class="language-csharp">[Lifetime(Lifetime.Scoped)]
public class AddTodoCommand(ILogger&lt;AddTodoCommand&gt; log, IDbConnection db)
    : IAsyncCommand&lt;CreateTodo&gt; {}
</code></pre>
<p>Or by manually registering them, if you need a custom registration:</p>
<pre><code class="language-csharp">services.AddTransient&lt;AddTodoCommand&gt;(c =&gt; CreateAddTodoCommand(c));
</code></pre>
<h3 id="commands-with-results">Commands with Results<a class="header-anchor" href="javascript:;" onclick="location.hash='#commands-with-results'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>For maximum flexibility, we want to encourage temporal decoupling by separating initiating a command from its execution,
so instead of adding a different method to execute commands with results, we're instead recommending the convention of
storing the result of a command in a <code>Result</code> property, e.g:</p>
<pre><code class="language-csharp">public interface IAsyncCommand&lt;in TRequest, out TResult&gt; 
    : IAsyncCommand&lt;TRequest&gt;, IHasResult&lt;TResult&gt; { }

public interface IHasResult&lt;out T&gt;
{
    T Result { get; }
}
</code></pre>
<p>So we could implement a command with a result like:</p>
<pre><code class="language-csharp">public class AddTodoCommand(ILogger&lt;AddTodoCommand&gt; log, IDbConnection db) 
    : IAsyncCommand&lt;CreateTodo, Todo&gt;
{
    public Todo Result { get; private set; }
    
    public async Task ExecuteAsync(CreateTodo request)
    {
        Result = request.ConvertTo&lt;Todo&gt;();
        Result.Id = await db.InsertAsync(newTodo, selectIdentity:true);
        log.LogDebug(&quot;Created Todo {Id}: {Text}&quot;, Result.Id, Result.Text);
    }
}
</code></pre>
<h3 id="messaging">Messaging<a class="header-anchor" href="javascript:;" onclick="location.hash='#messaging'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>Although for better resilience and scalability we recommend utilizing a messaging pattern to notify the outputs of a
command by publishing messages to invoke dependent logic instead of returning a result, e.g:</p>
<pre><code class="language-csharp">public class AddTodoCommand(IDbConnection db, IMessageProducer mq) 
    : IAsyncCommand&lt;CreateTodo&gt;
{
    public async Task ExecuteAsync(CreateTodo request)
    {
        var newTodo = request.ConvertTo&lt;Todo&gt;();
        newTodo.Id = await db.InsertAsync(newTodo, selectIdentity:true);
        mq.Publish(new SendNotification { TodoCreated = newTodo });
    }    
}
</code></pre>
<p>Which decouples the sender and receiver of the message, allowing it to finish without needing to wait and concern itself
on how subsequent logic is processed, e.g. how to handle errors, whether to execute it in a different managed thread, in parallel, etc.</p>
<p>Messaging encourages adopting a more reliable asynchronous one-way workflow instead of implementing logic serially where
the sender is timely coupled to the successful execution of all subsequent logic before being able to complete, e.g:</p>
<pre><code class="language-csharp">await cmd.ExecuteAsync(createTodo);
var newTodo = cmd.Result;
await SendNewTodoNotificationAsync(newTodo);
</code></pre>
<p>It allows for more reliable and observable workflows that removes the temporal coupling between components where each
execution step can be executed on different threads, independently monitored and retried if needed.</p>
<pre><code class="language-txt">[A] -&gt; [B] -&gt; [C]
</code></pre>
<h3 id="commands-as-application-building-blocks">Commands as Application Building Blocks<a class="header-anchor" href="javascript:;" onclick="location.hash='#commands-as-application-building-blocks'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>As they're not dependent on any framework and can support multiple execution patterns, we believe Commands make great
building blocks for insulating units of logic as they're simple and testable and allow for managed execution which can
easily add logging, monitoring, and resilience around your logic.</p>
<h3 id="background-mq">Background MQ<a class="header-anchor" href="javascript:;" onclick="location.hash='#background-mq'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>It should be noted adopting a messaging pattern doesn't require additional infrastructure complexity of an external MQ Server
as you can use the <a href="https://docs.servicestack.net/background-mq">Background MQ</a> to execute messages in configurable managed background threads.</p>
<h3 id="executing-commands">Executing Commands<a class="header-anchor" href="javascript:;" onclick="location.hash='#executing-commands'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>Commands are effectively a pattern to structure your logic that doesn't depend on any implementation assembly or
framework, so they can just be executed directly, e.g:</p>
<pre><code class="language-csharp">using var db = dbFactory.Open();
var cmd = new AddTodoCommand(new NullLogger&lt;AddTodoCommand&gt;(), db);
await cmd.ExecuteAsync(new CreateTodo { Text = &quot;New Todo&quot; });
</code></pre>
<h3 id="command-executor">Command Executor<a class="header-anchor" href="javascript:;" onclick="location.hash='#command-executor'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>They also allow for a managed execution which the <strong>CommandsFeature</strong> provides with its <code>ICommandExecutor</code> which
can be executed like:</p>
<pre><code class="language-csharp">public class MyService(ICommandExecutor executor) : Service
{
    public object Any(MyRequest request)
    {
        var cmd = executor.Command&lt;AddTodoCommand&gt;(); 
        await cmd.ExecuteAsync(new AddTodoCommand { Text = &quot;New Todo&quot; });
    }
}
</code></pre>
<p>This still results in the same behavior where exceptions are bubbled but also adds observability and resilience and
other niceties like executing any Fluent or Declarative Validation on Command Requests.</p>
<h3 id="retry-failed-commands">Retry Failed Commands<a class="header-anchor" href="javascript:;" onclick="location.hash='#retry-failed-commands'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>We can make commands more resilient by adding the <code>[Retry]</code> attribute to opt into auto retrying failed commands:</p>
<pre><code class="language-csharp">[Retry]
public class AddTodoCommand() : IAsyncCommand&lt;CreateTodo&gt; {}
</code></pre>
<p>Which will automatically retry the command as per the default Retry Policy:</p>
<pre><code class="language-csharp">services.AddPlugin(new CommandsFeature
{
    DefaultRetryPolicy = new(
        Times: 3,
        Behavior: RetryBehavior.FullJitterBackoff,
        DelayMs: 100,
        MaxDelayMs: 60_000,
        DelayFirst: false
    )
});
</code></pre>
<p>That can be overridden on a per-command basis with the <code>[Retry]</code> attribute, e.g:</p>
<pre><code class="language-csharp">[Retry(Times=4, MaxDelayMs=300_000, Behavior=RetryBehavior.LinearBackoff)]
public class AddTodoCommand() : IAsyncCommand&lt;CreateTodo&gt; {}
</code></pre>
<p>The different Retry Behaviors available include:</p>
<pre><code class="language-csharp">public enum RetryBehavior
{
    // Use the default retry behavior
    Default,
    
    // Always retry the operation after the same delay
    Standard,
    
    // Should be retried with a linear backoff delay strategy
    LinearBackoff,

    // Should be retried with an exponential backoff strategy
    ExponentialBackoff,

    // Should be retried with a full jittered exponential backoff strategy
    FullJitterBackoff,
}
</code></pre>
<h2 id="command-admin-ui">Command Admin UI<a class="header-anchor" href="javascript:;" onclick="location.hash='#command-admin-ui'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>Which can be inspected in the new <strong>Command Admin UI</strong> where you can view summary stats of all executed Commands and <strong>APIs</strong>
in the <strong>Summary</strong> tab, e.g:</p>
<p><a href="/img/posts/commands-feature/AddTodoCommand-summary.png"><img src="/img/posts/commands-feature/AddTodoCommand-summary.png" alt="" /></a></p>
<h3 id="latest-command-executions">Latest Command Executions<a class="header-anchor" href="javascript:;" onclick="location.hash='#latest-command-executions'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>It also maintains a rolling log of the latest executed commands in the <strong>Latest</strong> tab:</p>
<p><a href="/img/posts/commands-feature/AddTodoCommand-latest.png"><img src="/img/posts/commands-feature/AddTodoCommand-latest.png" alt="" /></a></p>
<h3 id="failed-command-executions">Failed Command Executions<a class="header-anchor" href="javascript:;" onclick="location.hash='#failed-command-executions'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>Whilst the <strong>Errors</strong> tab shows a list of all failed <strong>Command</strong> and <strong>API</strong> executions:</p>
<p><a href="/img/posts/commands-feature/AddTodoCommand-errors.png"><img src="/img/posts/commands-feature/AddTodoCommand-errors.png" alt="" /></a></p>
<h3 id="execute-internal-commands">Execute Internal Commands<a class="header-anchor" href="javascript:;" onclick="location.hash='#execute-internal-commands'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>A benefit of using Commands as the building block for your internal logic is that they enjoy many of the same benefits
of ServiceStack's message-based Services where they can be invoked using just the Command <strong>Name</strong> and a <strong>Request</strong> Body
which allows them to be discovered and executed from the <strong>Explore</strong> Tab:</p>
<p><a href="/img/posts/commands-feature/AddTodoCommand-execute.png"><img src="/img/posts/commands-feature/AddTodoCommand-execute.png" alt="" /></a></p>
<p>In this way they can be treated like <strong>Internal APIs</strong> for being able to invoke internal functionality that's only accessible
by <strong>Admin</strong> Users.</p>
<h3 id="group-commands-by-tag">Group Commands by Tag<a class="header-anchor" href="javascript:;" onclick="location.hash='#group-commands-by-tag'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>Just like ServiceStack Services they can be grouped by <strong>Tag</strong> which can be used to group related commands:</p>
<pre><code class="language-csharp">[Tag(&quot;Todos&quot;)]
public class AddTodoCommand() : IAsyncCommand&lt;CreateTodo&gt; {}
</code></pre>
<h2 id="mq-integration">MQ Integration<a class="header-anchor" href="javascript:;" onclick="location.hash='#mq-integration'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>Although <code>CommandsFeature</code> is a standalone feature we're registering it in the new Identity Auth Templates <code>Configure.Mq.cs</code>
which already uses the Background MQ to execute messages in managed background threads where it's used to send Identity Auth emails:</p>
<pre><code class="language-csharp">public class ConfigureMq : IHostingStartup
{
    public void Configure(IWebHostBuilder builder) =&gt; builder
        .ConfigureServices((context, services) =&gt; {
            services.AddSingleton&lt;IMessageService&gt;(c =&gt; new BackgroundMqService());
            services.AddPlugin(new CommandsFeature());
        })
        .ConfigureAppHost(afterAppHostInit: appHost =&gt; {
            var mqService = appHost.Resolve&lt;IMessageService&gt;();

            //Register ServiceStack APIs you want to be able to invoke via MQ
            mqService.RegisterHandler&lt;SendEmail&gt;(appHost.ExecuteMessage);
            mqService.Start();
        });
}
</code></pre>
<p>Despite being 2 independent features, they work well together as the Background MQ can be used to execute Commands in
managed background threads of which a single thread is used to execute each Request Type by default (configurable per request).</p>
<p>You'd typically want to use queues to improve scalability by reducing locking and concurrency contention of heavy resources
by having requests queued and executed in a managed background thread where it's able to execute requests as fast as it can without contention.
Queues are also a great solution for working around single thread limitations of resources like writes to SQLite databases.</p>
<h2 id="use-case-sqlite-writes">Use Case - SQLite Writes<a class="header-anchor" href="javascript:;" onclick="location.hash='#use-case-sqlite-writes'" aria-label="Permalink">&ZeroWidthSpace;</a></h2>
<p>As we've started to use server-side SQLite databases for our new Apps given its <a href="https://docs.servicestack.net/ormlite/litestream">many benefits</a>
we needed a solution to workaround its limitation of not being able to handle multiple writes concurrently.</p>
<p>One of the benefits of using SQLite is creating and managing multiple databases is relatively cheap, so we can mitigate
this limitation somewhat by maintaining different subsystems in separate databases, e.g:</p>
<p><a href="/img/posts/commands-feature/pvq-databases.png"><img src="/img/posts/commands-feature/pvq-databases.png" alt="" /></a></p>
<p>But each database can only be written to by a single thread at a time, which we can now easily facilitate with
<strong>Background MQ</strong> and <strong>MQ Command DTOs</strong>.</p>
<h3 id="mq-command-dtos">MQ Command DTOs<a class="header-anchor" href="javascript:;" onclick="location.hash='#mq-command-dtos'" aria-label="Permalink">&ZeroWidthSpace;</a></h3>
<p>We can use the new <code>[Command]</code> attribute to be able to execute multiple commands on a single Request DTO Properties, e.g:</p>
<pre><code class="language-csharp">[Tag(Tag.Tasks)]
[Restrict(RequestAttributes.MessageQueue), ExcludeMetadata]
public class DbWrites : IGet, IReturn&lt;EmptyResponse&gt;
{
    [Command&lt;CreatePostVoteCommand&gt;]
    public Vote? CreatePostVote { get; set; }
    
    [Command&lt;CreateCommentVoteCommand&gt;]
    public Vote? CreateCommentVote { get; set; }
    
    [Command&lt;CreatePostCommand&gt;]
    public Post? CreatePost { get; set; }
    
    [Command&lt;UpdatePostCommand&gt;]
    public Post? UpdatePost { get; set; }
    
    [Command&lt;DeletePostsCommand&gt;]
    public DeletePosts? DeletePosts { get; set; }
    
    [Command&lt;DeleteAnswersCommand&gt;]
    public DeleteAnswers? DeleteAnswers { get; set; }
    
    [Command&lt;CreateAnswerCommand&gt;]
    public Post? CreateAnswer { get; set; }
    
    [Command&lt;PostSubscriptionsCommand&gt;]
    public PostSubscriptions? PostSubscriptions { get; set; }
    
    [Command&lt;TagSubscriptionsCommand&gt;]
    public TagSubscriptions? TagSubscriptions { get; set; }    
    //...
}
</code></pre>
<p>Then to execute the commands we can use the <code>Request.ExecuteCommandsAsync</code> extension method for its
Background MQ API implementation:</p>
<pre><code class="language-csharp">public class BackgroundMqServices : Service
{
    public Task Any(DbWrites request) =&gt; Request.ExecuteCommandsAsync(request);
}
</code></pre>
<p>Which goes through all Request DTO properties to execute all populated properties with their associated
command, using it as the request for the command.</p>
<p>So after registering the <code>DbWrites</code> Command DTO with the MQ Service:</p>
<pre><code class="language-csharp">mqService.RegisterHandler&lt;DbWrites&gt;(appHost.ExecuteMessage);
</code></pre>
<p>We can now publish a single <code>DbWrites</code> message to execute multiple commands in a single managed background thread, e.g:</p>
<pre><code class="language-csharp">public class NotificationServices(MessageProducer mq) : Service
{
    public object Any(Watch request)
    {
        var userName = Request.GetClaimsPrincipal().GetUserName();

        mq.Publish(new DbWrites
        {
            PostSubscriptions = request.PostId == null ? null : new()
            {
                UserName = userName,
                Subscriptions = [request.PostId.Value],
            },
            TagSubscriptions = request.Tag == null ? null : new()
            {
                UserName = userName,
                Subscriptions = [request.Tag],
            },
        });
        
        mq.Publish(new AnalyticsTasks {
            WatchRequest = request,
        });
    }
}
</code></pre>
<p>We also benefit from its natural parallelism where write requests to different Databases are executed in parallel.</p>

                </div>
            </div>
        </article>
</div>

<div id="comments" data-post="PostComments" class="my-48"></div>

        <div class="bg-gray-50 py-20">
            <div class="max-w-3xl mx-auto">
                <div class="flex justify-between">
                    <div>
                            <a href="posts/author/demis-bellot"><img class="w-20 h-20 rounded-full text-cyan-600" src="/img/authors/demis.jpg"></a>

                        <div class="mt-2 font-medium text-2xl">
                            Written by Demis Bellot
                        </div>
                        <div class="text-gray-600">
                            Father of 3 when not deving @ servicestack.net
                        </div>
                    </div>
                    <div class="flex items-end">
            <ul role="list" class="flex">
                    <li>
                        <a title="Follow on Twitter" class="mr-1 group flex text-sm font-medium text-zinc-800 transition hover:text-indigo-500 dark:text-zinc-200 dark:hover:text-indigo-500" href="https://twitter.com/demisbellot">
                            <svg viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6 flex-none text-zinc-500 fill-zinc-500 transition group-hover:fill-indigo-500">
                                <path d="M20.055 7.983c.011.174.011.347.011.523 0 5.338-3.92 11.494-11.09 11.494v-.003A10.755 10.755 0 0 1 3 18.186c.308.038.618.057.928.058a7.655 7.655 0 0 0 4.841-1.733c-1.668-.032-3.13-1.16-3.642-2.805a3.753 3.753 0 0 0 1.76-.07C5.07 13.256 3.76 11.6 3.76 9.676v-.05a3.77 3.77 0 0 0 1.77.505C3.816 8.945 3.288 6.583 4.322 4.737c1.98 2.524 4.9 4.058 8.034 4.22a4.137 4.137 0 0 1 1.128-3.86A3.807 3.807 0 0 1 19 5.274a7.657 7.657 0 0 0 2.475-.98c-.29.934-.9 1.729-1.713 2.233A7.54 7.54 0 0 0 22 5.89a8.084 8.084 0 0 1-1.945 2.093Z"></path>
                            </svg>
                        </a>
                    </li>
                    <li>
                        <a title="Follow on threads.net" class="mr-1 group flex text-sm font-medium text-zinc-800 transition hover:text-indigo-500 dark:text-zinc-200 dark:hover:text-indigo-500" href="https://threads.net/@demisbellot">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 flex-none text-zinc-500 fill-zinc-500 transition group-hover:fill-indigo-500" width="24" height="24" viewBox="0 0 24 24">
                                <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7.5c-1.333-3-3.667-4.5-7-4.5c-5 0-8 2.5-8 9s3.5 9 8 9s7-3 7-5s-1-5-7-5c-2.5 0-3 1.25-3 2.5C9 15 10 16 11.5 16c2.5 0 3.5-1.5 3.5-5s-2-4-3-4s-1.833.333-2.5 1"/>
                            </svg>
                        </a>
                    </li>
                    <li>
                        <a title="Follow on GitHub" class="mr-1 group flex text-sm font-medium text-zinc-800 transition hover:text-indigo-500 dark:text-zinc-200 dark:hover:text-indigo-500" href="https://github.com/mythz">
                            <svg viewBox="0 0 24 24" aria-hidden="true" class="h-6 w-6 flex-none text-zinc-500 fill-zinc-500 transition group-hover:fill-indigo-500">
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C6.475 2 2 6.588 2 12.253c0 4.537 2.862 8.369 6.838 9.727.5.09.687-.218.687-.487 0-.243-.013-1.05-.013-1.91C7 20.059 6.35 18.957 6.15 18.38c-.113-.295-.6-1.205-1.025-1.448-.35-.192-.85-.667-.013-.68.788-.012 1.35.744 1.538 1.051.9 1.551 2.338 1.116 2.912.846.088-.666.35-1.115.638-1.371-2.225-.256-4.55-1.14-4.55-5.062 0-1.115.387-2.038 1.025-2.756-.1-.256-.45-1.307.1-2.717 0 0 .837-.269 2.75 1.051.8-.23 1.65-.346 2.5-.346.85 0 1.7.115 2.5.346 1.912-1.333 2.75-1.05 2.75-1.05.55 1.409.2 2.46.1 2.716.637.718 1.025 1.628 1.025 2.756 0 3.934-2.337 4.806-4.562 5.062.362.32.675.936.675 1.897 0 1.371-.013 2.473-.013 2.82 0 .268.188.589.688.486a10.039 10.039 0 0 0 4.932-3.74A10.447 10.447 0 0 0 22 12.253C22 6.588 17.525 2 12 2Z"></path>
                            </svg>
                        </a>
                    </li>
                    <li>
                        <a title="Email Demis Bellot" href="mailto:demis@servicestack.com" class="mr-1 group flex text-sm font-medium text-zinc-800 transition hover:text-indigo-500 dark:text-zinc-200 dark:hover:text-indigo-500">
                            <svg class="h-6 w-6 flex-none text-zinc-500 fill-zinc-500 transition group-hover:fill-indigo-500" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M4 20q-.825 0-1.413-.588T2 18V6q0-.825.588-1.413T4 4h16q.825 0 1.413.588T22 6v12q0 .825-.588 1.413T20 20H4Zm8-7L4 8v10h16V8l-8 5Zm0-2l8-5H4l8 5ZM4 8V6v12V8Z"/></svg>
                        </a>
                    </li>
            </ul>
                    </div>
                </div>

                <div class="mt-4 border-t">
                    <div class="py-8 text-lg text-gray-700 font-medium">
                        More from Demis Bellot
                    </div>
                    <div class="grid grid-cols-2 gap-8">
                            <div>
                                <div class="flex flex-col overflow-hidden">
                                    <div class="flex-shrink-0">
                                        <a href="posts/llms-py-ui">
                                            <img class="h-48 w-full object-cover" src="./img/posts/llms-py-ui/bg.webp" alt="">
                                        </a>
                                    </div>
                                    <div class="flex flex-1 flex-col justify-between bg-white dark:bg-black p-6">
                                        <div class="flex-1">
                                            <p class="text-sm font-medium text-indigo-600 dark:text-indigo-300">
                                                Article
                                            </p>
                                            <a href="posts/llms-py-ui" class="mt-2 block">
                                                <p class="text-xl font-semibold text-gray-900 dark:text-gray-50 whitespace-nowrap overflow-hidden text-ellipsis" title="llms.py gets a UI &#x1F680;">
                                                    llms.py gets a UI &#x1F680;
                                                </p>
                                                <p class="mt-3 text-base text-gray-500">Simple ChatGPT-like UI to access ALL Your LLMs, Locally or Remotely!</p>
                                            </a>
                                        </div>
                                        <div class="mt-6 flex items-center">
                                            <div class="flex-shrink-0">
                                                <a href="">
                                                    <span class="sr-only">Demis Bellot</span>
                                                    <img class="h-10 w-10 rounded-full" src="/img/authors/demis.jpg" alt="llms.py gets a UI &#x1F680; background">
                                                </a>
                                            </div>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-gray-900">
                                                        <a href="posts/author/demis-bellot" class="hover:underline">Demis Bellot</a>
                                                </p>
                                                <div class="flex space-x-1 text-sm text-gray-500">
                                                    <time datetime="2025-09-30T00:00:00.0000000">September 30, 2025</time>
                                                    <span aria-hidden="true">&middot;</span>
                                                    <span>5 min read</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div>
                                <div class="flex flex-col overflow-hidden">
                                    <div class="flex-shrink-0">
                                        <a href="posts/llms-py">
                                            <img class="h-48 w-full object-cover" src="./img/posts/llms-py/bg.webp" alt="">
                                        </a>
                                    </div>
                                    <div class="flex flex-1 flex-col justify-between bg-white dark:bg-black p-6">
                                        <div class="flex-1">
                                            <p class="text-sm font-medium text-indigo-600 dark:text-indigo-300">
                                                Article
                                            </p>
                                            <a href="posts/llms-py" class="mt-2 block">
                                                <p class="text-xl font-semibold text-gray-900 dark:text-gray-50 whitespace-nowrap overflow-hidden text-ellipsis" title="llms.py - Lightweight OpenAI compatible CLI and server gateway for multiple LLMs">
                                                    llms.py - Lightweight OpenAI compatible CLI and server gateway for multiple LLMs
                                                </p>
                                                <p class="mt-3 text-base text-gray-500">Support for Text, Image and Audio generation. Seamlessly mix and match local models with premium cloud LLMs</p>
                                            </a>
                                        </div>
                                        <div class="mt-6 flex items-center">
                                            <div class="flex-shrink-0">
                                                <a href="">
                                                    <span class="sr-only">Demis Bellot</span>
                                                    <img class="h-10 w-10 rounded-full" src="/img/authors/demis.jpg" alt="llms.py - Lightweight OpenAI compatible CLI and server gateway for multiple LLMs background">
                                                </a>
                                            </div>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-gray-900">
                                                        <a href="posts/author/demis-bellot" class="hover:underline">Demis Bellot</a>
                                                </p>
                                                <div class="flex space-x-1 text-sm text-gray-500">
                                                    <time datetime="2025-09-25T00:00:00.0000000">September 25, 2025</time>
                                                    <span aria-hidden="true">&middot;</span>
                                                    <span>5 min read</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div>
                                <div class="flex flex-col overflow-hidden">
                                    <div class="flex-shrink-0">
                                        <a href="posts/text-to-blazor-upgraded">
                                            <img class="h-48 w-full object-cover" src="./img/posts/text-to-blazor-upgraded/bg.webp" alt="">
                                        </a>
                                    </div>
                                    <div class="flex flex-1 flex-col justify-between bg-white dark:bg-black p-6">
                                        <div class="flex-1">
                                            <p class="text-sm font-medium text-indigo-600 dark:text-indigo-300">
                                                Article
                                            </p>
                                            <a href="posts/text-to-blazor-upgraded" class="mt-2 block">
                                                <p class="text-xl font-semibold text-gray-900 dark:text-gray-50 whitespace-nowrap overflow-hidden text-ellipsis" title="Text to Blazor CRUD upgraded to use best LLMs">
                                                    Text to Blazor CRUD upgraded to use best LLMs
                                                </p>
                                                <p class="mt-3 text-base text-gray-500">Discover how to quickly generate Blazor Admin CRUD Apps from a text description using the new okai tool</p>
                                            </a>
                                        </div>
                                        <div class="mt-6 flex items-center">
                                            <div class="flex-shrink-0">
                                                <a href="">
                                                    <span class="sr-only">Demis Bellot</span>
                                                    <img class="h-10 w-10 rounded-full" src="/img/authors/demis.jpg" alt="Text to Blazor CRUD upgraded to use best LLMs background">
                                                </a>
                                            </div>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-gray-900">
                                                        <a href="posts/author/demis-bellot" class="hover:underline">Demis Bellot</a>
                                                </p>
                                                <div class="flex space-x-1 text-sm text-gray-500">
                                                    <time datetime="2025-09-02T00:00:00.0000000">September 2, 2025</time>
                                                    <span aria-hidden="true">&middot;</span>
                                                    <span>7 min read</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div>
                                <div class="flex flex-col overflow-hidden">
                                    <div class="flex-shrink-0">
                                        <a href="posts/hosting-llama-server">
                                            <img class="h-48 w-full object-cover" src="./img/posts/hosting-llama-server/bg.webp" alt="">
                                        </a>
                                    </div>
                                    <div class="flex flex-1 flex-col justify-between bg-white dark:bg-black p-6">
                                        <div class="flex-1">
                                            <p class="text-sm font-medium text-indigo-600 dark:text-indigo-300">
                                                Article
                                            </p>
                                            <a href="posts/hosting-llama-server" class="mt-2 block">
                                                <p class="text-xl font-semibold text-gray-900 dark:text-gray-50 whitespace-nowrap overflow-hidden text-ellipsis" title="Using llama.cpp to self-host Large Language Models in Production">
                                                    Using llama.cpp to self-host Large Language Models in Production
                                                </p>
                                                <p class="mt-3 text-base text-gray-500">A practical guide to self-hosting LLMs in production using llama.cpp&#x27;s llama-server with Docker compose and Systemd</p>
                                            </a>
                                        </div>
                                        <div class="mt-6 flex items-center">
                                            <div class="flex-shrink-0">
                                                <a href="">
                                                    <span class="sr-only">Demis Bellot</span>
                                                    <img class="h-10 w-10 rounded-full" src="/img/authors/demis.jpg" alt="Using llama.cpp to self-host Large Language Models in Production background">
                                                </a>
                                            </div>
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-gray-900">
                                                        <a href="posts/author/demis-bellot" class="hover:underline">Demis Bellot</a>
                                                </p>
                                                <div class="flex space-x-1 text-sm text-gray-500">
                                                    <time datetime="2025-06-03T00:00:00.0000000">June 3, 2025</time>
                                                    <span aria-hidden="true">&middot;</span>
                                                    <span>10 min read</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                    </div>
                </div>
            </div>
        </div>

<script type="module">
import { init } from "app.mjs"
init()
</script>

<link rel="stylesheet" href="css/highlight.css">
<script src="js/highlight.js"></script>
<script>hljs.highlightAll()</script>
<script src="js/lite-yt-embed.js"></script>
<script src="mjs/docs.mjs" type="module"></script>


<script type="module">
import { mount } from "app.mjs"

    const App = {
        setup() {
            function nav(url) {
                window.open(url)
            }
            return { nav }
        }
    }
    mount('#post', App)
</script>

    </main>
</div>

<footer class="bg-slate-200 dark:bg-black border-t border-slate-300 dark:border-gray-600 py-8 sm:py-12">
    <div class="max-w-screen-2xl mx-auto px-5">
        <div class="sm:flex sm:flex-wrap sm:-mx-4 md:py-4">
            <div class="px-4 sm:w-1/2 md:w-1/4 xl:w-1/6">
                <h5 class="block uppercase text-slate-500 font-semibold mb-4">Features</h5>
                <div>
                    <a href="https://servicestack.net/service-reference" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">ServiceStack Reference</a>
                    <a href="https://servicestack.net/creatorkit/" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">CreatorKit</a>
                    <a href="https://servicestack.net/litestream" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Litestream</a>
                    <a href="https://servicestack.net/ormlite" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">OrmLite</a>
                    <a href="https://servicestack.net/redis" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Redis</a>
                    <a href="https://servicestack.net/locode" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Locode</a>
                    <a href="https://www.jamstacks.net" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Jamstack</a>
                </div>
            </div>
            <div class="px-4 sm:w-1/2 md:w-1/4 xl:w-1/6 mt-8 sm:mt-0">
                <h5 class="block uppercase text-slate-500 font-semibold mb-4">Resources</h5>
                <div>
                    <a href="https://docs.servicestack.net" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Framework Docs</a>
                    <a href="https://forums.servicestack.net" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Customer Forums</a>
                    <a href="https://docs.servicestack.net/redis/" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">ServiceStack.Redis</a>
                    <a href="https://docs.servicestack.net/ormlite/" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">ServiceStack.OrmLite</a>
                    <a href="https://docs.servicestack.net/text" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">ServiceStack.Text</a>
                    <a href="https://docs.servicestack.net/aws" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">ServiceStack.Aws</a>
                    <a href="https://github.com/NetCoreApps/LiveDemos" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Live Demos</a>
                    <a href="https://servicestack.net/posts/" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Blog Archive</a>
                </div>
            </div>
            <div class="px-4 sm:w-1/2 md:w-1/4 xl:w-1/6 mt-8 md:mt-0">
                <h5 class="block uppercase text-slate-500 font-semibold mb-4">Learn</h5>
                <div>
                    <a href="https://docs.servicestack.net/why-servicestack" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Why ServiceStack</a>
                    <a href="https://docs.servicestack.net/architecture-overview" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Architecture</a>
                    <a href="https://docs.servicestack.net/explore-servicestack" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Explore ServiceStack</a>
                    <a href="https://docs.servicestack.net/api-first-development" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">API First Development</a>
                    <a href="https://docs.servicestack.net/service-complexity-and-dto-roles" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">The Simple POCO Life</a>
                    <a href="https://servicestack.net/training" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Training Services</a>
                </div>
            </div>
            <div class="px-4 sm:w-1/2 md:w-1/4 xl:w-1/6 mt-8 md:mt-0">
                <h5 class="block uppercase text-slate-500 font-semibold mb-4">About</h5>
                <div>
                    <a href="https://servicestack.net/support" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Support</a>
                    <a href="https://servicestack.net/whatsnew" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">What's New</a>
                    <a href="https://servicestack.net/#contact" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Contact Us</a>
                    <a href="https://servicestack.net/privacy" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Privacy</a>
                    <a href="https://servicestack.net/terms" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Terms</a>
                </div>
            </div>
            <div class="px-4 mt-4 flex justify-end">
                <div class="max-w-sm">
                    <div class="mx-auto">
                        <h5 class="block uppercase text-slate-500 font-semibold mb-4">Stay connected</h5>

                        <div class="mt-6 lg:mb-0 mb-6">
                            <a href="https://twitter.com/ServiceStack" class="inline-block bg-white dark:bg-gray-800 p-2 text-blue-400 shadow-lg font-normal items-center justify-center align-center rounded-full outline-none focus:outline-none mr-2">
                                <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M22.46 6c-.77.35-1.6.58-2.46.69c.88-.53 1.56-1.37 1.88-2.38c-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29c0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15c0 1.49.75 2.81 1.91 3.56c-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07a4.28 4.28 0 0 0 4 2.98a8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21C16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56c.84-.6 1.56-1.36 2.14-2.23Z"/></svg>
                            </a>
                            <a href="https://www.youtube.com/channel/UC0kXKGVU4NHcwNdDdRiAJSA" class="inline-block bg-white dark:bg-gray-800 p-2 text-red-600 shadow-lg font-normal items-center justify-center align-center rounded-full outline-none focus:outline-none mr-2">
                                <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M21.543 6.498C22 8.28 22 12 22 12s0 3.72-.457 5.502c-.254.985-.997 1.76-1.938 2.022C17.896 20 12 20 12 20s-5.893 0-7.605-.476c-.945-.266-1.687-1.04-1.938-2.022C2 15.72 2 12 2 12s0-3.72.457-5.502c.254-.985.997-1.76 1.938-2.022C6.107 4 12 4 12 4s5.896 0 7.605.476c.945.266 1.687 1.04 1.938 2.022zM10 15.5l6-3.5l-6-3.5v7z"/></svg>
                            </a>
                            <a href="https://github.com/ServiceStack" class="inline-block bg-white dark:bg-gray-800 p-2 text-slate-800 shadow-lg font-normal items-center justify-center align-center rounded-full outline-none focus:outline-none mr-2">
                                <svg class="h-6 w-6 dark:text-white" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33c.85 0 1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z"/></svg>
                            </a>
                        </div>
                    </div>
                    <div class="mt-8" data-mail="JoinMailingList" data-props="{ submitLabel:'Join our newsletter' }"></div>
                </div>
            </div>
        </div>

        <div class="sm:flex sm:flex-wrap sm:-mx-4 mt-6 pt-6 sm:mt-12 sm:pt-12 border-t dark:border-gray-700">
            <div class="sm:w-full px-4 md:w-1/6">
                <b>About ServiceStack</b>
            </div>
            <div class="px-4 sm:w-1/2 mt-4 md:mt-0 text-sm text-gray-600">
                ServiceStack started development in 2008 with the mission of creating a best-practices services framework
                with an emphasis on simplicity and speed, reducing the effort in creating and maintaining resilient
                message-based SOA Services and rich web apps like <a href="https://ubixar.com">ubixar</a>.

                <p class="pt-2">Copyright (c) ServiceStack Inc. 2024</p>
            </div>
            <div class="px-4 md:w-1/4 md:ml-auto mt-6 sm:mt-4 md:mt-0">
                <a href="https://servicestack.net/start"
                   class="bg-slate-800 text-white active:bg-slate-600 text-sm font-semibold uppercase px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150">
                    Get started
                </a>
            </div>
        </div>        
        
    </div>
</footer>

<script type="module">
import { mail } from 'https://creatorkit.servicestack.net/mjs/components/mail.mjs'
import { post } from 'https://creatorkit.servicestack.net/mjs/components/post.mjs'

mail('[data-mail]', { mailingLists:['MonthlyNewsletter'] })
post('[data-post]', {
    commentLink: { 
        href: '/community-rules',
        label: 'read the community rules'
    } 
})
</script>


<script type="module">
import { init } from "app.mjs"
init()
</script>



</body>
</html>