<!doctype html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TZZ1VK3VGL"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date()); gtag('config', 'G-TZZ1VK3VGL');</script>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/svg" href="img/logo.svg">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="https://servicestack.net/feed.xml" />
    <title>Text to Blazor App - ServiceStack</title>
    <base href="/" />
    <script>
    if (location.search === "?dark") localStorage.setItem('color-scheme','dark') 
    if (location.search === "?light") localStorage.removeItem('color-scheme') 
    const cls = document.querySelector('html').classList
    if (localStorage.getItem('color-scheme') === 'dark')
        cls.add('dark')
    else
        cls.remove('dark')
    </script>
    <link rel="stylesheet" href="css/app.css">

    <script type="importmap">
{
    "imports": {
        "app.mjs": "./mjs/app.mjs",
        "dtos.mjs": "./mjs/dtos.mjs",
        "vue": "./lib/mjs/vue.min.mjs",
        "@servicestack/client": "./lib/mjs/servicestack-client.min.mjs",
        "@servicestack/vue": "./lib/mjs/servicestack-vue.min.mjs",
        "highlight.mjs": "./lib/mjs/highlight.mjs",
        "core": "./js/core.mjs"
    }
}
</script>
    
</head>
<body class="bg-white dark:bg-black dark:text-white">
<header class="top-0 fixed z-50 h-14 bg-white dark:bg-black opacity-90 w-full shadow pr-3">
    <div class="w-full flex flex-wrap items-center">
        <div class="absolute z-10 top-2 left-2 sm:static flex-shrink flex-grow-0">
            <div class="cursor-pointer">
                <a class="navbar-brand flex items-center" href="./">
                    <svg class="w-8 h-8 sm:ml-2 sm:w-12 sm:h-12 text-gray-900 dark:text-gray-50" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path fill="currentColor" d="M10 6c1.544 1.76 2.276 4.15 2.217 6.61c3.968 1.67 9.924 6.12 11.181 12.39H28C26.051 14.31 14.918 6.77 10 6zm-2 7c4.67 4.913.81 11.582-4 12h18.97C21.5 18.289 11.95 13.533 8 13z"/></svg>
                    <span class="hidden sm:block text-2xl font-bold text-gray-900 dark:text-gray-50">ServiceStack</span>
                </a>
            </div>
        </div>
        <div class="flex flex-grow flex-shrink flex-nowrap justify-end items-center">
            <nav class="relative flex flex-grow leading-6 font-semibold text-slate-700 dark:text-slate-200">
                <ul class="flex flex-wrap items-center justify-end w-full m-0 pb-2 sm:pb-0">
                            <li class="relative flex flex-wrap just-fu-start m-0">
                                <a href="https://servicestack.net/whatsnew" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400">
                                    What's New
                                </a>
                            </li>
                            <li class="relative flex flex-wrap just-fu-start m-0">
                                <a href="https://servicestack.net/blog" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400">
                                    Blog
                                </a>
                            </li>
                            <li class="relative flex flex-wrap just-fu-start m-0 hidden lg:block">
                                <a href="https://servicestack.net/podcasts" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400">
                                    Podcasts
                                </a>
                            </li>
                            <li class="relative flex flex-wrap just-fu-start m-0 hidden lg:block">
                                <a href="https://docs.servicestack.net" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400">
                                    Docs
                                </a>
                            </li>
                            <li class="relative flex flex-wrap just-fu-start m-0 hidden lg:block">
                                <a href="https://forums.servicestack.net" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400">
                                    Forums
                                </a>
                            </li>
                            <li class="relative flex flex-wrap just-fu-start m-0">
                                <a href="https://servicestack.net/free" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400">
                                    Free
                                </a>
                            </li>
                            <li class="relative flex flex-wrap just-fu-start m-0">
                                <a href="https://servicestack.net/trial" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400">
                                    Trial
                                </a>
                            </li>
                            <li class="relative flex flex-wrap just-fu-start m-0">
                                <a href="https://servicestack.net/pricing" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400">
                                    Pricing
                                </a>
                            </li>
                            <li class="relative flex flex-wrap just-fu-start m-0">
                                <a href="https://servicestack.net/account/subscription" class="p-4 flex items-center justify-start mw-full hover:text-sky-500 dark:hover:text-sky-400 text-gray-50 sm:text-slate-700 dark:text-gray-50">
                                    Sign In
                                </a>
                            </li>
                    <li class="relative flex flex-wrap just-fu-start m-0">
                        <div data-component="DarkModeToggle" class="ml-2 w-10"></div>
                    </li>
                </ul>
            </nav>

        </div>
    </div>
</header>
<script type="module">
import { mountAll } from "app.mjs"
mountAll()
</script>


<div class="min-h-screen">
    <main role="main" class="pt-14">
        <style>
.cm-s-default {
    height: 100% !important;
}
/*
blue-500 #3b82f6
green-500 #22c55e
 */
.container {
}
</style>
<div class="pb-12 pt-16 sm:pb-4 lg:pt-12">
    <div>
        <div class="mx-auto px-4 sm:px-6 md:max-w-4xl md:px-4 lg:px-0">
            <h1 class="mb-8 text-6xl md:text-7xl font-bold tracking-tighter leading-tight">
                <label for="prompt" class="flex items-center">
                    <a href="/text-to-blazor">
                        <img src="/img/svgs/blazor.svg" alt="Blazor Vue Logo" class="mr-4 w-16 h-16 inline-block align-middle">
                    </a>
                    Text to Blazor CRUD App
                </label>
            </h1>
        </div>
    </div>

    <div id="app" class="mx-auto lg:max-w-7xl">

        <div v-if="!generation" class="mx-auto lg:max-w-4xl xl:max-w-5xl">
            <div class="flex justify-center mb-4">
                <div class="w-48">
                    <label for="project" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Project Name</label>
                    <div class="mt-1 relative shadow-sm rounded-md">
                        <input type="text" name="project" id="project"
                               class="block w-full sm:text-sm rounded-md dark:text-white dark:bg-gray-900 disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 disabled:shadow-none shadow-sm focus:ring-indigo-500 focus:border-indigo-500 border-gray-300 dark:border-gray-600"
                               placeholder="Project Name"
                               autocomplete="off" spellcheck="false"
                               v-model="project">
                    </div>
                </div>
            </div>

            <div class="w-section flex justify-between items-center max-fullscreen">
                <button @click="navGen(-1)" type="button" title="Previous Generation">
                    <svg v-if="routes.id" class="w-24 h-24 cursor-pointer text-slate-300 hover:text-indigo-600" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g fill="none" fill-rule="evenodd"><path d="M24 0v24H0V0zM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.019-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"/><path fill="currentColor" d="M8.293 12.707a1 1 0 0 1 0-1.414l5.657-5.657a1 1 0 1 1 1.414 1.414L10.414 12l4.95 4.95a1 1 0 0 1-1.414 1.414z"/></g></svg>
                </button>
                <div class="mt-1 w-full relative shadow-sm rounded-md">
                    <textarea id="prompt" class="flex-grow border py-2 px-3 text-2xl block w-full rounded-md dark:text-white dark:bg-gray-900 disabled:bg-slate-50 disabled:text-slate-500 disabled:border-slate-200 disabled:shadow-none focus:ring-indigo-500 focus:border-indigo-500 border-gray-300 dark:border-gray-600"
                              type="text" autocomplete="off" spellcheck="false" autofocus="true" style="height:180px"
                              placeholder="Describe what data models you need for the App do you want to create?" v-model="prompt"></textarea>
                </div>
                <button @click="navGen(1)" type="button" title="Next Generation">
                    <svg v-if="routes.id" class="w-24 h-24 cursor-pointer text-slate-300 hover:text-indigo-600" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g fill="none" fill-rule="evenodd"><path d="M24 0v24H0V0zM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.019-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"/><path fill="currentColor" d="M15.707 11.293a1 1 0 0 1 0 1.414l-5.657 5.657a1 1 0 1 1-1.414-1.414l4.95-4.95l-4.95-4.95a1 1 0 0 1 1.414-1.414z"/></g></svg>
                </button>
            </div>
            
            <div class="text-center">
                <div class="error-summary invalid-feedback my-1"></div>
            </div>

            <div class="mx-auto max-w-md px-4 text-center sm:max-w-3xl sm:px-6 lg:max-w-7xl lg:px-8">
                <div class="mt-5 mb-8 flex justify-center gap-8">
                    <button id="btnGenerate" @click="generate($event)" type="button" :disabled="!prompt || prompt == gist?.description || loadingGeneration" 
                            class="cursor-pointer rounded-full bg-white dark:bg-slate-700 px-8 py-3 text-xl text-slate-600 hover:text-slate-800 disabled:text-slate-400 disabled:bg-gray-100 hover:bg-gray-50 border-2 border-indigo-500 disabled:border-slate-300 hover:border-green-500 rounded-md shadow disabled:shadow-none focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-300">
                        Generate App
                    </button>
                </div>
                <div v-if="loadingGeneration" class="mb-8 flex justify-center">
                    <form-loading text="generating..."></form-loading>
                </div>
            </div>
        </div>
        <div v-else v-cloak>
            <div v-if="!routes.id" class="mx-auto max-w-7xl px-6 lg:px-8">
                <div class="mb-4">
                    <div class="mx-auto flex items-center justify-center">
                        <p class="relative rounded-full px-4 py-1.5 text-sm/6 text-gray-600 ring-1 ring-gray-900/10 ring-inset">
                            {{generation.description}}
                        </p>
                        <span class="ml-2" title="New Generation" @click="clearGeneration()">
                            <svg class="cursor-pointer w-5 h-5 text-gray-500 hover:text-red-700" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" d="m12 13.4l2.9 2.9q.275.275.7.275t.7-.275t.275-.7t-.275-.7L13.4 12l2.9-2.9q.275-.275.275-.7t-.275-.7t-.7-.275t-.7.275L12 10.6L9.1 7.7q-.275-.275-.7-.275t-.7.275t-.275.7t.275.7l2.9 2.9l-2.9 2.9q-.275.275-.275.7t.275.7t.7.275t.7-.275zm0 8.6q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12t-2.325-5.675T12 4T6.325 6.325T4 12t2.325 5.675T12 20m0-8"/></svg>
                        </span>
                    </div>
                </div>
                <div class="mb-4">
                    <div class="sm:hidden">
                        <label for="tabs" class="sr-only">Select a tab</label>
                        <!-- Use an "onChange" listener to redirect the user to the selected tab URL. -->
                        <select id="tabs" name="tabs" @change="routes.to({ model:$event.target.value, id:undefined, page:undefined, pageSize:undefined })"
                                class="block w-full rounded-md border-gray-300 focus:border-indigo-500 focus:ring-indigo-500">
                            <option v-for="(file,model) in generation.files" :value="model">{{file.filename}}</option>
                        </select>
                    </div>
                    <div class="hidden sm:block">
                        <div class="border-b border-gray-200">
                            <nav class="-mb-px flex" aria-label="Tabs">
                                <!-- Current: "border-indigo-500 text-indigo-600", Default: "border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700" -->
                                <div v-for="(file,model) in generation.files" v-href="{ model, id:undefined, page:undefined, pageSize:undefined }"
                                     :class="['cursor-pointer w-1/4 border-b-2 px-1 py-2 text-center text-sm font-medium text-gray-500', model == selectedModel ? 'border-indigo-500 text-indigo-600' : 'border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700']">
                                    <div class="flex flex-col justify-center items-center">
                                        <img :src="getIcon(model)" class="w-8 h-8">
                                        <span class="mt-3">{{model}}</span>
                                    </div>
                                </div>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
            <div v-else-if="routes.id && gist">
                <div class="mb-4 mx-auto max-w-sm">
                    <button v-href="{id:undefined}" type="button" class="inline-flex w-full justify-center gap-x-1.5 rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50" id="menu-button" aria-expanded="true" aria-haspopup="true">
                        View Generation
                        <svg class="-mr-1 size-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
                            <path fill-rule="evenodd" d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"/>
                        </svg>
                    </button>
                </div>
                <div v-if="gist.description" class="mb-4 flex items-center justify-center mx-auto relative ">
                    <button @click="navGen(-1)" type="button" title="Previous Generation">
                        <svg v-if="routes.id" class="w-8 h-8 cursor-pointer text-slate-300 hover:text-indigo-600" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g fill="none" fill-rule="evenodd"><path d="M24 0v24H0V0zM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.019-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"/><path fill="currentColor" d="M8.293 12.707a1 1 0 0 1 0-1.414l5.657-5.657a1 1 0 1 1 1.414 1.414L10.414 12l4.95 4.95a1 1 0 0 1-1.414 1.414z"/></g></svg>
                    </button>
                    <p class="rounded-full px-4 py-1.5 text-sm/6 text-gray-600 ring-1 ring-gray-900/10 ring-inset">
                        {{gist.description}}
                    </p>
                    <button @click="navGen(1)" type="button" title="Next Generation">
                        <svg v-if="routes.id" class="w-8 h-8 cursor-pointer text-slate-300 hover:text-indigo-600" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g fill="none" fill-rule="evenodd"><path d="M24 0v24H0V0zM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.019-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"/><path fill="currentColor" d="M15.707 11.293a1 1 0 0 1 0 1.414l-5.657 5.657a1 1 0 1 1-1.414-1.414l4.95-4.95l-4.95-4.95a1 1 0 0 1 1.414-1.414z"/></g></svg>
                    </button>
                </div>
            </div>
        </div>
        <div v-if="gist" v-cloak>
            <gist-view :gist="gist" :icon="getIcon(useModel)"></gist-view>
            
            <div class="mt-4 flex justify-center items-center" v-cloak>
                <svg class="mr-1 w-5 h-5 text-indigo-600" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" d="m12 16l-5-5l1.4-1.45l2.6 2.6V4h2v8.15l2.6-2.6L17 11zm-6 4q-.825 0-1.412-.587T4 18v-3h2v3h12v-3h2v3q0 .825-.587 1.413T18 20z"/></svg>
                <div class="text-gray-500">download</div>
                <img v-if="useModel" :src="getIcon(useModel)" class="ml-1.5 size-5 shrink-0" alt="Model Icon" :title="'download ' + useModel + ' data models'">
            </div>
            
            <div class="mt-4 flex justify-center" v-cloak>
                <div>
                    <a class="archive-url hover:no-underline" :href="archiveUrl('blazor-admin')" title="Download new Blazor Admin App">
                        <div class="bg-white dark:bg-gray-800 px-4 py-4 mr-4 mb-4 rounded-lg shadow-lg text-center items-center justify-center hover:shadow-2xl dark:border-2 dark:border-pink-600 dark:hover:border-blue-600 dark:border-2 dark:border-pink-600 dark:hover:border-blue-600" style="min-width: 150px;">
                            <div class="text-center font-extrabold flex items-center justify-center mb-2">
                                <div class="text-4xl text-blue-400 my-3">
                                    <img class="w-12 h-12" src="/img/svgs/blazor.svg" alt="Blazor Admin Logo">
                                </div>
                            </div>
                            <div class="flex justify-center h-8">
                                <div class="mr-1"><span class="px-2 h-8 rounded-lg bg-blue-50 dark:bg-blue-900 text-blue-500 dark:text-blue-400 text-sm">internal</span></div>
                            </div>        
                            <div class="mb-3 text-xl font-medium text-gray-700 dark:text-gray-200">Admin Only</div>
                            <div class="archive-name px-4 pb-2 text-blue-600 dark:text-indigo-400">{{project}}.zip</div>
                        </div>
                    </a>
                </div>
                <div>
                    <a class="archive-url hover:no-underline" :href="archiveUrl('blazor-vue')" title="Download new Blazor Vue App">
                        <div class="bg-white dark:bg-gray-800 px-4 py-4 mr-4 mb-4 rounded-lg shadow-lg text-center items-center justify-center hover:shadow-2xl dark:border-2 dark:border-pink-600 dark:hover:border-blue-600 dark:border-2 dark:border-pink-600 dark:hover:border-blue-600" style="min-width: 150px;">
                            <div class="text-center font-extrabold flex items-center justify-center mb-2">
                                <div class="text-4xl text-blue-400 my-3">
                                    <img class="w-12 h-12" src="/img/svgs/blazor.svg" alt="Blazor Vue Logo">
                                </div>
                            </div>
                            <div class="flex justify-center h-8">
                                <div class="mr-1"><span class="px-2 h-8 rounded-lg bg-blue-50 dark:bg-blue-900 text-blue-500 dark:text-blue-400 text-sm">public</span></div>
                            </div>
                            <div class="mb-3 text-xl font-medium text-gray-700 dark:text-gray-200">UI + Admin</div>
                            <div class="archive-name px-4 pb-2 text-blue-600 dark:text-indigo-400">{{project}}.zip</div>
                        </div>
                    </a>
                </div>
            </div>            
        </div>

        <div class="my-24" v-cloak>
            <div class="mx-auto lg:max-w-5xl overflow-hidden bg-white sm:rounded-lg sm:shadow-sm">
                <div class="border-b border-gray-200 bg-white px-4 py-5 sm:px-6">
                    <div class="-mt-4 -ml-4 flex flex-wrap items-center justify-between sm:flex-nowrap">
                        <div class="mt-4 ml-4">
                            <h3 class="text-base font-semibold text-gray-900">Generated Applications</h3>
                            <p class="mt-1 text-sm text-gray-500">Download existing Blazor CRUD Apps</p>
                        </div>
                        <pages-nav class="mt-4 w-2/3" path="/imagine" :total="accepted.length" :page-size="parseInt(routes.pageSize) || 10" :page="Math.max(1,routes.page ?? 1)"></pages-nav>
                    </div>
                </div>
                <ul role="list" class="divide-y divide-gray-200">
                    <li v-for="info in infos" :class="[info.id == routes.id ? 'bg-indigo-600 text-white' : 'text-gray-600 hover:bg-gray-50']">
                        <span v-href="{id:info.id, model:undefined}" class="cursor-pointer block">
                            <div class="px-4 py-4 sm:px-6">
                                <div class="flex items-center justify-between">
                                    <div class="truncate text-sm font-medium">{{info.prompt}}</div>
                                </div>
                                <div class="mt-2 flex justify-between">
                                    <div class="sm:flex">
                                        <div class="flex items-center text-sm">
                                            <img :src="getIcon(info.model)" class="mr-1.5 size-5 shrink-0" alt="Model Icon">
                                            {{info.model}}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </span>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

<link rel="stylesheet" href="/codemirror/lib/codemirror.css">
<link rel="stylesheet" href="/codemirror/theme/mocha.css" />
<script src="/codemirror/lib/codemirror.js"></script>
<script src="/codemirror/mode/clike/clike.js"></script>
<script src="/codemirror/mode/javascript/javascript.js"></script>
<script src="/codemirror/addon/edit/matchbrackets.js"></script>
<script src="/codemirror/addon/selection/active-line.js"></script>


<script type="module">
import { ref, computed, watch, reactive, onMounted, nextTick } from "vue"
import { App, usePageRoutes } from "core"
import { JsonServiceClient, rightPart, lastRightPart } from "@servicestack/client"
import ServiceStackVue from "@servicestack/vue"
import PagesNav from "./mjs/components/PagesNav.mjs"
import GistView from "./mjs/components/GistView.mjs"

export const icons = {
    'llama3.1:70b':         '/img/models/llama.svg',
    'llama3.3:70b':         '/img/models/llama.svg',
    'llama3:8b':            '/img/models/llama.svg',
    'phi-4:14b':            '/img/models/phi4.svg',
    'codestral:22b':        '/img/models/codestral.svg',
    'mistral:7b':           '/img/models/mistral.svg',
    'mistral-nemo:12b':     '/img/models/mistral-nemo.svg',
    'mixtral:8x7b':         '/img/models/mixtral.jpg',
    'mixtral:8x22b':        '/img/models/mixtral.jpg',
    'mistral-small:24b':    '/img/models/mistral.svg',
    'mistral-large:123b':   '/img/models/mistral.svg',
    'nova-micro':           '/img/models/aws.svg',
    'nova-lite':            '/img/models/aws.svg',
    'nova-pro':             '/img/models/aws.svg',
    'gpt-3.5-turbo':        '/img/models/gpt-3.5.svg',
    'gpt-4':                '/img/models/gpt-4.svg',
    'gpt-4-turbo':          '/img/models/gpt-4.svg',
    'gpt-4o':               '/img/models/gpt-4.svg',
    'gpt-4o-mini':          '/img/models/gpt-4.svg',
    'o1-preview':           '/img/models/gpt-4.svg',
    'o1-mini':              '/img/models/gpt-4.svg',
    'o3-mini':              '/img/models/gpt-4.svg',
    'deepseek-v3:671b':     '/img/models/deepseek-3.jpg',
    'deepseek-r1:671b':     '/img/models/deepseek.jpg',
    'deepseek-r1:70b':      '/img/models/deepseek.jpg',
    'qwen2.5:72b':          '/img/models/qwen.svg',
    'qwen2.5-coder:32b':    '/img/models/qwen.svg',
    'qwq:32b':              '/img/models/qwen.svg',
    'qwq:72b':              '/img/models/qwen.svg',
    'qwen-turbo':           '/img/models/qwen.svg',
    'qwen-plus':            '/img/models/qwen.svg',
    'qwen-max':             '/img/models/qwen.svg',
    'gemma2:9b':            '/img/models/gemma.svg',
    'claude-3-haiku':       '/img/models/claude-3-haiku.svg',
    'claude-3-sonnet':      '/img/models/claude-3-sonnet.svg',
    'claude-3-5-haiku':     '/img/models/claude-3-haiku.svg',
    'claude-3-5-sonnet':    '/img/models/claude-3-5-sonnet.svg',
    'gemini-pro-1.5':       '/img/models/gemini-pro.svg',
    'gemini-flash-1.5':     '/img/models/gemini-pro.svg',
    'gemini-flash-1.5-8b':  '/img/models/gemini-pro.svg',
    'gemini-pro-2.0':       '/img/models/gemini-pro.svg',
    'gemini-flash-2.0':     '/img/models/gemini-pro.svg',
    'gemini-flash-lite-2.0':'/img/models/gemini-pro.svg',
    'gemini-flash-thinking-2.0': '/img/models/gemini-pro.svg',
}

const app = new App()
app.use(ServiceStackVue)
app.component('RouterLink', ServiceStackVue.component('RouterLink'))
const client = window.client = new JsonServiceClient()
const events = app.events

let routes = usePageRoutes(app, {
    page:'imagine',
    queryKeys: ('model,id,q,page,skip,show,orderBy,pageSize,tab').split(','),
    handlers: {
        init(state) { console.debug('init', state) }, /*debug*/
        nav(state) { console.debug('nav', state) } /*debug*/
    },
})

let store = {
    gistCache: {}
}
store = reactive(store)
globalThis.store = store

const AppComponent = {
    components: {
        PagesNav,
        GistView,
    },
    setup() {
        const project = ref('Acme')
        const prompt = ref('')
        const accepted = ref([])
        const gist = ref()
        const loadingGeneration = ref(false)
        const loadingGist = ref(false)
        const generation = ref()
        const useModel = computed(() => selectedModel.value ?? gist.value ? rightPart(gist.value.owner,'/') : '')
        const archiveUrl = (template) => !gist.value?.id ? null 
            : `https://account.servicestack.net/archive/NetCoreTemplates/${template}?Name=${project.value}&okai=${gist.value.id}`
        
        const selectedModel = computed(() => routes.model || Object.keys(generation.value?.files || {})[0])
        const infos = computed(() => {
            const skip = ((routes.page || 1) - 1) * (routes.pageSize || 10)
            return accepted.value.slice(skip, skip + (routes.pageSize || 10))
        })
        
        const generationId = computed(() => selectedModel.value &&
            lastRightPart(generation.value?.files[selectedModel.value]?.raw_url, '/') 
            || lastRightPart(Object.values(generation.value?.files || {})[0]?.raw_url, '/'))

        watch(() => routes.model, () => {
            console.log('routes.model', routes.model)
            const genId = generationId.value
            gist.value = null
            if (genId && store.gistCache[genId]) {
                nextTick(() => {
                    gist.value = store.gistCache[generationId.value]
                })
            }
        })

        watch(() => routes.id,  async (id, oldId) => {
            console.log('routes.id', routes.id, id, oldId)
            if (!id) {
                gist.value = null
                const genId = generationId.value
                if (genId && store.gistCache[genId]) {
                    nextTick(() => {
                        gist.value = store.gistCache[genId]
                    })
                }
                return
            }
            if (store.gistCache[id]) {
                gist.value = null
                nextTick(() => {
                    if (routes.id === id) {
                        gist.value = store.gistCache[id]
                        if (gist.value.description) {
                            prompt.value = gist.value.description
                        }
                    }
                })
                return
            }
            const url = `https://okai.servicestack.com/models/gist?prompt=${id}&include=all,-header&template=blazor-vue&project=${project.value}`
            const r = await fetch(url)
            const gistObj = await r.json()
            gist.value = null
            nextTick(() => {
                if (routes.id === id) {
                    gist.value = store.gistCache[id] = gistObj
                    if (gist.value.description) {
                        prompt.value = gist.value.description
                    }
                }
            })
        })
        
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
        
        async function generate(e) {
            loadingGeneration.value = true
            await sleep(2000)
            let cached = e.ctrlKey // hold CTRL to use cached model
            let generateModelsUrl = new URL('https://okai.servicestack.com/models/gist')
            function addQueryParams(args) {
                for (const [k,v] of Object.entries(args)) {
                    generateModelsUrl.searchParams.set(k, v)
                }
            }
            if (cached) {
                addQueryParams({ prompt: 1735872878252, cached: 1 })
            } else {
                addQueryParams({ 
                    prompt: prompt.value, 
                    include: 'all,-header', 
                    project: project.value, 
                    template: 'blazor-vue' 
                })
            }
            const r = await fetch(generateModelsUrl)
            generation.value = await r.json()
            await Promise.all(Object.keys(generation.value.files).map(async model => {
                const id = lastRightPart(generation.value.files[model].raw_url, '/')
                const r = await fetch(`https://okai.servicestack.com/models/gist?prompt=${id}&include=all,-header&template=blazor-vue&project=${project.value}`)
                store.gistCache[id] = await r.json()
            }))
            gist.value = store.gistCache[generationId.value]
            loadingGeneration.value = false
        }

        function getIcon(model) {
            return 'https://openai.servicestack.net' + (icons[model] || '/img/models/gpt-4.svg')
        }
        
        function clearGeneration() {
            generation.value = null
            routes.to({ model:undefined, id:undefined, page:undefined, pageSize:undefined, tab:undefined })
        }
        
        function navGen(pos) {
            const gen = accepted.value.find(x => x.id == routes.id)
            if (!gen) {
                routes.to({ id: accepted.value[0].id })
            } else {
                const idx = accepted.value.indexOf(gen)
                let nextPos = idx + pos
                const next = nextPos < 0 
                    ? accepted.value[accepted.value.length - 1]
                    : accepted.value[nextPos % accepted.value.length]
                if (next) {
                    routes.to({ id: next.id })
                }
            }
        }

        onMounted(async () => {
            const r = await fetch(`/okai/accepted/index.json?t=${Date.now()}`)
            accepted.value = await r.json()
            accepted.value.reverse()
        })
        
        return {
            store, 
            routes, 
            project,
            prompt,
            accepted,
            infos,
            gist,
            useModel,
            loadingGeneration,
            loadingGist,
            selectedModel,
            generation,
            generationId,
            archiveUrl,
            generate,
            getIcon,
            clearGeneration,
            navGen,
            rightPart,
        }
    }
}

app.provides({ client, events, routes, store, })

app.build(AppComponent).mount('#app')
app.start()
</script>
    </main>
</div>

<footer class="bg-slate-200 dark:bg-black border-t border-slate-300 dark:border-gray-600 py-8 sm:py-12">
    <div class="max-w-screen-2xl mx-auto px-5">
        <div class="sm:flex sm:flex-wrap sm:-mx-4 md:py-4">
            <div class="px-4 sm:w-1/2 md:w-1/4 xl:w-1/6">
                <h5 class="block uppercase text-slate-500 font-semibold mb-4">Features</h5>
                <div>
                    <a href="https://servicestack.net/service-reference" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">ServiceStack Reference</a>
                    <a href="https://servicestack.net/creatorkit/" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">CreatorKit</a>
                    <a href="https://servicestack.net/litestream" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Litestream</a>
                    <a href="https://servicestack.net/ormlite" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">OrmLite</a>
                    <a href="https://servicestack.net/redis" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Redis</a>
                    <a href="https://servicestack.net/locode" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Locode</a>
                    <a href="https://www.jamstacks.net" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Jamstack</a>
                </div>
            </div>
            <div class="px-4 sm:w-1/2 md:w-1/4 xl:w-1/6 mt-8 sm:mt-0">
                <h5 class="block uppercase text-slate-500 font-semibold mb-4">Resources</h5>
                <div>
                    <a href="https://docs.servicestack.net" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Framework Docs</a>
                    <a href="https://forums.servicestack.net" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Customer Forums</a>
                    <a href="https://docs.servicestack.net/redis/" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">ServiceStack.Redis</a>
                    <a href="https://docs.servicestack.net/ormlite/" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">ServiceStack.OrmLite</a>
                    <a href="https://docs.servicestack.net/text" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">ServiceStack.Text</a>
                    <a href="https://docs.servicestack.net/aws" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">ServiceStack.Aws</a>
                    <a href="https://github.com/NetCoreApps/LiveDemos" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Live Demos</a>
                    <a href="https://servicestack.net/posts/" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Blog Archive</a>
                </div>
            </div>
            <div class="px-4 sm:w-1/2 md:w-1/4 xl:w-1/6 mt-8 md:mt-0">
                <h5 class="block uppercase text-slate-500 font-semibold mb-4">Learn</h5>
                <div>
                    <a href="https://docs.servicestack.net/why-servicestack" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Why ServiceStack</a>
                    <a href="https://docs.servicestack.net/architecture-overview" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Architecture</a>
                    <a href="https://docs.servicestack.net/explore-servicestack" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Explore ServiceStack</a>
                    <a href="https://docs.servicestack.net/api-first-development" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">API First Development</a>
                    <a href="https://docs.servicestack.net/service-complexity-and-dto-roles" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">The Simple POCO Life</a>
                    <a href="https://servicestack.net/training" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Training Services</a>
                </div>
            </div>
            <div class="px-4 sm:w-1/2 md:w-1/4 xl:w-1/6 mt-8 md:mt-0">
                <h5 class="block uppercase text-slate-500 font-semibold mb-4">About</h5>
                <div>
                    <a href="https://servicestack.net/support" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Support</a>
                    <a href="https://servicestack.net/whatsnew" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">What's New</a>
                    <a href="https://servicestack.net/#contact" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Contact Us</a>
                    <a href="https://servicestack.net/privacy" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Privacy</a>
                    <a href="https://servicestack.net/terms" class="text-slate-600 hover:text-slate-800 dark:hover:text-slate-100 font-semibold block pb-2 text-sm">Terms</a>
                </div>
            </div>
            <div class="px-4 mt-4 flex justify-end">
                <div class="max-w-sm">
                    <div class="mx-auto">
                        <h5 class="block uppercase text-slate-500 font-semibold mb-4">Stay connected</h5>

                        <div class="mt-6 lg:mb-0 mb-6">
                            <a href="https://twitter.com/ServiceStack" class="inline-block bg-white dark:bg-gray-800 p-2 text-blue-400 shadow-lg font-normal items-center justify-center align-center rounded-full outline-none focus:outline-none mr-2">
                                <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M22.46 6c-.77.35-1.6.58-2.46.69c.88-.53 1.56-1.37 1.88-2.38c-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29c0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15c0 1.49.75 2.81 1.91 3.56c-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07a4.28 4.28 0 0 0 4 2.98a8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21C16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56c.84-.6 1.56-1.36 2.14-2.23Z"/></svg>
                            </a>
                            <a href="https://www.youtube.com/channel/UC0kXKGVU4NHcwNdDdRiAJSA" class="inline-block bg-white dark:bg-gray-800 p-2 text-red-600 shadow-lg font-normal items-center justify-center align-center rounded-full outline-none focus:outline-none mr-2">
                                <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M21.543 6.498C22 8.28 22 12 22 12s0 3.72-.457 5.502c-.254.985-.997 1.76-1.938 2.022C17.896 20 12 20 12 20s-5.893 0-7.605-.476c-.945-.266-1.687-1.04-1.938-2.022C2 15.72 2 12 2 12s0-3.72.457-5.502c.254-.985.997-1.76 1.938-2.022C6.107 4 12 4 12 4s5.896 0 7.605.476c.945.266 1.687 1.04 1.938 2.022zM10 15.5l6-3.5l-6-3.5v7z"/></svg>
                            </a>
                            <a href="https://github.com/ServiceStack" class="inline-block bg-white dark:bg-gray-800 p-2 text-slate-800 shadow-lg font-normal items-center justify-center align-center rounded-full outline-none focus:outline-none mr-2">
                                <svg class="h-6 w-6 dark:text-white" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33c.85 0 1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z"/></svg>
                            </a>
                        </div>
                    </div>
                    <div class="mt-8" data-mail="JoinMailingList" data-props="{ submitLabel:'Join our newsletter' }"></div>
                </div>
            </div>
        </div>

        <div class="sm:flex sm:flex-wrap sm:-mx-4 mt-6 pt-6 sm:mt-12 sm:pt-12 border-t dark:border-gray-700">
            <div class="sm:w-full px-4 md:w-1/6">
                <b>About ServiceStack</b>
            </div>
            <div class="px-4 sm:w-1/2 mt-4 md:mt-0 text-sm text-gray-600">
                ServiceStack started development in 2008 with the mission of creating a best-practices services framework
                with an emphasis on simplicity and speed, reducing the effort in creating and maintaining resilient
                message-based SOA Services and rich web apps like <a href="https://pvq.app">pvq</a>.

                <p class="pt-2">Copyright (c) ServiceStack Inc. 2024</p>
            </div>
            <div class="px-4 md:w-1/4 md:ml-auto mt-6 sm:mt-4 md:mt-0">
                <a href="https://servicestack.net/start"
                   class="bg-slate-800 text-white active:bg-slate-600 text-sm font-semibold uppercase px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150">
                    Get started
                </a>
            </div>
        </div>        
        
    </div>
</footer>

<script type="module">
import { mail } from 'https://creatorkit.servicestack.net/mjs/components/mail.mjs'
import { post } from 'https://creatorkit.servicestack.net/mjs/components/post.mjs'

mail('[data-mail]', { mailingLists:['MonthlyNewsletter'] })
post('[data-post]', {
    commentLink: { 
        href: '/community-rules',
        label: 'read the community rules'
    } 
})
</script>


<script type="module">
import { init } from "app.mjs"
init()
</script>



</body>
</html>